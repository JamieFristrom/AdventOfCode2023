#include "pch.h"

#include <functional>
#include <numeric>
#include <ranges>
#include <set>


template<typename ReturnValue, typename IngestContainer, typename BinaryOperation>
[[nodiscard]] ReturnValue qAccumulate(const IngestContainer& c, ReturnValue init, BinaryOperation binaryOp) {
	return std::accumulate(c.begin(), c.end(), init, binaryOp);
}

template<typename ReturnContainer, typename IngestContainer, typename UnaryOperation>
[[nodiscard]] ReturnContainer qTransform(const IngestContainer& c, UnaryOperation unaryOp) {
	ReturnContainer newC;
	std::transform(c.begin(), c.end(), std::back_inserter(newC), unaryOp);
	return newC;
}

// not to be confused with qsort :P
template<typename Container>
[[nodiscard]] Container qSort(const Container& c) {
	Container newC = c;
	std::sort(newC.begin(), newC.end());
	return newC;
}


template<typename Container>
typename Container::value_type qMaxElementValue(const Container& c) {
	return *std::max_element(c.begin(), c.end());
}

template<typename Container>
bool qAllOf(const Container& c, std::function<bool(typename Container::value_type)> predicate) {
	return std::all_of(c.begin(), c.end(), predicate);
}

template<typename Container>
bool qAnyOf(const Container& c) {
	return std::any_of(c.begin(), c.end());
}

template<typename Container>
int64_t qCount(const Container& c, typename Container::value_type match) {
	return static_cast<int64_t>(std::count(c.begin(), c.end(), match));
}

template<typename Container>
int64_t qCountIf(const Container& c, std::function<bool(typename Container::value_type)> predicate) {
	return static_cast<int64_t>(std::count_if(c.begin(), c.end(), predicate));
}

template<typename Container>
Container qConcatenate(const Container& c1, const Container& c2) {
	Container result = c1;
	result.insert(result.end(), c2.begin(), c2.end());
	return result;
}

template<typename Container>
Container interleave(const Container& c1, const Container& c2) {
	Container result;
	auto c1it = c1.begin();
	auto c2it = c2.begin();
	for (;;) {
		if (c1it == c1.end() && c2it == c2.end()) break;
		if (c1it != c1.end()) {
			result.emplace_back(*c1it);
			c1it++;
		}
		if (c2it != c2.end()) {
			result.emplace_back(*c2it);
			c2it++;
		}
	}
	return result;
}

std::vector<std::string> split(const std::string& str, char delim) {
	std::stringstream strstream(str);
	std::vector<std::string> result;
	for (std::string line; std::getline(strstream, line, delim);) {
		result.emplace_back(line);
	}
	return result;
}

using namespace std;


// make minPerms to minimumPermuations+2 divisions to the total
using Groups = vector<int64_t>;
using Permutations = vector<Groups>;

Permutations memoTable[256][256];

// maxCount is inclusive. we can't throw away things below min count because
// they might get built into longer chains
Permutations makePermutations(int64_t total, int64_t maxCount) {
	if (total == 0) {
		return {};
	}
	if (!memoTable[maxCount][total].empty()) {
		return memoTable[maxCount][total];
	}

	Permutations result{ { total } };
	for (int64_t i = total-1; i > 0; i--)
	{
		auto remainingPerms = makePermutations(total - i, maxCount);
		auto filtered = remainingPerms
			| views::filter([maxCount](Groups& groups) {
				return std::ssize(groups) < maxCount; // need space to add a new element
				});
		Permutations innerResult(filtered.begin(), filtered.end());
		for (auto permIt = innerResult.begin(); permIt != innerResult.end(); permIt++ ) {
			permIt->insert(permIt->begin(), i);
		}
		result.insert(result.end(), innerResult.begin(), innerResult.end());
	}
	memoTable[maxCount][total] = result;
	return result;
}

// groups goes gap-group-gap-group-gap-group-(optional)gap. First gap is 0 if 0.
bool patternMatch(const Groups& groups, const string& pattern) {
	string resultStr;
	bool isGap = true;
	bool firstElement = true;
	for (auto& group : groups) {
		assert(firstElement || group > 0);
		firstElement = false;
		for (int i = 0; i < group; i++) {
			resultStr.push_back(isGap ? '.' : '#');
		}
		isGap = !isGap;
	}
	assert(resultStr.size() == pattern.size());
	for (int64_t i = 0; i < std::ssize(resultStr); i++) {
		if (pattern[i] != '?') {
			if (pattern[i] != resultStr[i]) {
				return false;
			}
		}
	}
	std::cout << resultStr << std::endl;
	return true;
}



int64_t findArrangements(const string& pattern, const Groups& groups) {
	// we need to make permutations of sizes of gaps
	// outer gaps can be 0 but inner ones can't, that's a bit annoying
	int64_t sum = std::accumulate(groups.begin(), groups.end(), 0ll);
	auto spaces = std::ssize(pattern) - sum;
	auto perms = makePermutations(spaces, std::ssize(groups) + 1);
	// throw out any permutations that have too few pieces
	auto shortOnes = perms | views::filter([groupsSize = std::ssize(groups)](Groups& gaps) {
		return std::ssize(gaps) >= groupsSize - 1 ; 
		});
	// now which ones match
	int64_t count = 0;
	for (auto& gaps : shortOnes) {
		// turn gap patterns into patterns of gaps & groups
		// you can tell I'm getting very tired
		if (gaps.size() == groups.size() + 1) {
			vector<int64_t> gapsAndGroups = interleave(gaps, groups);
			if (patternMatch(gapsAndGroups, pattern)) {
				count++;
			}
		}
		else if (gaps.size() == groups.size() - 1) {
			gaps.insert(gaps.begin(), 0);
			const vector<int64_t> gapsAndGroups = interleave(gaps, groups);
			if (patternMatch(gapsAndGroups, pattern)) {
				count++;
			}
		}
		else if (gaps.size()==groups.size()) {
			// gap can come before or after. 
			// first after
			const vector<int64_t> gapsAndGroups = interleave(gaps, groups);
			if (patternMatch(gapsAndGroups, pattern)) {
				count++;
			}
			gaps.insert(gaps.begin(), 0);
			const vector<int64_t> gapsAndGroups2 = interleave(gaps, groups);
			if (patternMatch(gapsAndGroups2, pattern)) {
				count++;
			}
		}
	}
	return count;
}

int64_t findArrangements2(const string& pattern, const Groups& groups) {
	string newPattern = pattern + pattern + pattern + pattern + pattern;
	Groups newGroups;
	for (int i = 0; i < 5; i++) {
		newGroups = qConcatenate(newGroups, groups);
	}
	return findArrangements2(newPattern, newGroups);
}

int64_t doTheThing(const vector<pair<string, vector<int64_t>>>& input) {
	int64_t sum = 0;
	for (auto& item : input) {
		sum += findArrangements(item.first, item.second);
	}
	return sum;
}

TEST(TestCaseName, PermutationGenerator) {
	ASSERT_EQ(Permutations{ Groups{1} }, makePermutations(1,100));
	Permutations perms2{ Groups{2}, Groups{ 1,1 } };
	ASSERT_EQ(perms2, makePermutations(2, 100));
	Permutations perms3{ Groups{3}, Groups{ 2,1 }, Groups{ 1,2 }, Groups{ 1,1,1 } };
	ASSERT_EQ(perms3, makePermutations(3, 100));
	Permutations perms3_2{ Groups{3}, Groups{ 2,1 }, Groups{ 1,2 } };
	ASSERT_EQ(perms3_2, makePermutations(3, 2));
	Permutations perms4{ Groups{4}, Groups{ 3,1}, Groups{2,2}, Groups{2,1,1}, Groups{1,3}, Groups{1,2,1}, Groups{1,1,2}, Groups{1,1,1,1} };
	ASSERT_EQ(perms4, makePermutations(4, 100));
	Permutations perms4_3{ Groups{4}, Groups{ 3,1}, Groups{2,2}, Groups{2,1,1}, Groups{1,3}, Groups{1,2,1}, Groups{1,1,2}};
	ASSERT_EQ(perms4_3, makePermutations(4, 3));
	Permutations perms4_2{ Groups{4}, Groups{ 3,1}, Groups{2,2}, Groups{1,3} };
	ASSERT_EQ(perms4_2, makePermutations(4, 2));
}


TEST(TestCaseName, PatternMatcher) {
	ASSERT_EQ(true, patternMatch(Groups{ 0,1,1,1,1,3 }, "???.###"));
	ASSERT_EQ(false, patternMatch(Groups{ 1,1,1,1,1,2 }, "???.###"));
	ASSERT_EQ(true, patternMatch(Groups{ 1,1,4,1,3,3,1 }, ".??..??...?##."));
	ASSERT_EQ(false, patternMatch(Groups{ 0,1,4,1,4,3,1 }, ".??..??...?##."));
}
TEST(TestCaseName, part1Samples) {
	ASSERT_EQ(findArrangements("???.###", { 1,1,3 }), 1 );
	ASSERT_EQ(findArrangements(".??..??...?##.", { 1,1,3 }), 4 );
	ASSERT_EQ(findArrangements("?#?#?#?#?#?#?#?", { 1,3,1,6 }), 1 );
	ASSERT_EQ(findArrangements("????.#...#...", { 4,1,1 }), 1 );
	ASSERT_EQ(findArrangements("????.######..#####.", { 1,6,5 }), 4 );
	ASSERT_EQ(findArrangements("?###????????", { 3,2,1 }), 10 );
}

TEST(TestCaseName, part2Samples0) {
	ASSERT_EQ(findArrangements2("???.###", { 1,1,3 }), 1);
}

TEST(TestCaseName, part2Samples) {
	ASSERT_EQ(findArrangements2(".??..??...?##.", { 1,1,3 }), 4);
	ASSERT_EQ(findArrangements2("?#?#?#?#?#?#?#?", { 1,3,1,6 }), 1);
	ASSERT_EQ(findArrangements2("????.#...#...", { 4,1,1 }), 1);
	ASSERT_EQ(findArrangements2("????.######..#####.", { 1,6,5 }), 4);
	ASSERT_EQ(findArrangements2("?###????????", { 3,2,1 }), 10);
}

TEST(TestCaseName, Interleave) {
	vector<int64_t> a{ 1,3,5 };
	vector<int64_t> b{ 2,4,6,7 };
	vector<int64_t> resultA{ 1, 2, 3, 4, 5, 6, 7 };
	ASSERT_EQ(resultA, interleave(a, b));
	vector<int64_t> resultB{ 2, 1, 4, 3, 6, 5, 7 };
	ASSERT_EQ(resultB, interleave(b, a));
}

const vector<pair<string,vector<int64_t>>> puzzleInput = {
{string("?#.???#???????##?.?"),{2,1,7,3,1}},
{string("?.##?###?#?##?"),{1,6,1,2}},
{string("??.???.?.?.??.???."),{2,2,1,1,2,1}},
{string("?????#???#??#??..?#?"),{15,2}},
{string("#?????????#.?#"),{1,2,5,1}},
{string("??..?.???#"),{1,4}},
{string("?##???.????"),{3,2,2}},
{string("..??.????????.??"),{1,3}},
{string(".?????????.#??"),{1,6,2}},
{string("?#?#??????##??#..#"),{1,2,7,1}},
{string("??.?????###??"),{3,4}},
{string(".???????#.?"),{4,3,1}},
{string("??????#.?#????"),{2,2,4}},
{string("???.???#?..?????."),{2,1,1,5}},
{string("???#???#???#?#?????."),{2,9,2}},
{string("????.#.?????#?#"),{1,6}},
{string("???????.#??"),{1,1,2}},
{string("#????#??.???."),{2,1,1,1}},
{string("??#?????.????"),{2,1,1,1}},
{string(".#?.?.#????#?.#"),{1,1,4,1}},
{string("##?????##???"),{3,3,2}},
{string("??.?????#?"),{1,1,3}},
{string("??????.??????##.??#?"),{2,2,1,6,3}},
{string("?#???.?#??"),{1,1,4}},
{string("#?#???.????"),{4,1,2}},
{string(".#.?.??#??"),{1,1,3}},
{string(".?#???#??#??#?#?."),{1,10}},
{string("?##...?##???.?"),{2,5}},
{string(".#??????????????"),{8,1,1}},
{string("???...???#"),{1,1,1}},
{string("??#???.?????????#??"),{3,4,4}},
{string("????.?.???.#.??"),{1,1,3,1,1}},
{string("?#??.?#???"),{2,1,3}},
{string("?????##????#????"),{11,1}},
{string("??????.????"),{4,1}},
{string("?????#?..?#?.??"),{2,2,3,1}},
{string("??????.#..?#????#"),{2,1,4,1}},
{string("??.???#..#?"),{1,2,2}},
{string("#?#??.#????#?"),{1,1,1,2}},
{string("?.#?..?#??"),{2,4}},
{string("?.?????##??.#?????##"),{8,8}},
{string("???.???.??."),{1,2}},
{string("??#??????#"),{7,1}},
{string("????#?####?#?#"),{9,1,1}},
{string("???#??#.????."),{1,4,2}},
{string("??#?#?????.##??.?.??"),{5,1,1,4,1,1}},
{string(".#??.??????#?????#?"),{1,1,5,3}},
{string("???#???.????#???."),{4,1,4}},
{string(".?.??#??????#??."),{3,5}},
{string("???????..??"),{1,2,2}},
{string("????#.????????"),{2,2}},
{string("?.????????##??"),{3,2}},
{string("?.?.????????#??????#"),{1,2,4,4,1}},
{string("???#??.????.???#???"),{4,1,1,3}},
{string("????????????.."),{5,1}},
{string("??.#??????##"),{1,1,1,2}},
{string("..?.?#?????.?.."),{3,1}},
{string("??#??.?#??.??#?????"),{4,3,3,2}},
{string("???#?#???##????##??"),{5,7,2,1}},
{string(".????#?????#.."),{5,2}},
{string("..?#..##???.?"),{2,3}},
{string("???????.?.?"),{4,1}},
{string("#????????#?????."),{1,3,1,6}},
{string("?#?#??.??.?#????."),{1,3,1,6}},
{string("?#???.??#??."),{4,3}},
{string("?#.#.????#?#?????#?"),{2,1,8,4}},
{string("??.#???????.?"),{2,2,1}},
{string("..???????.?"),{2,3}},
{string("?#.??????????"),{1,7}},
{string("?.??#??#????????????"),{1,7,3,1,1}},
{string("???????.#?????"),{3,3,5}},
{string("?..????.???#."),{1,1,2,1}},
{string("?.?????.?#.??..?"),{3,1}},
{string(".#?..?##????"),{1,4}},
{string("?????...???????"),{3,2}},
{string("???.?.??????"),{2,1,1,3}},
{string("#???#.#?#???"),{5,5}},
{string("????#???.???"),{5,1,2}},
{string("????#????#?.??##?#?"),{1,4,2,4,2}},
{string("??#???????????."),{2,1,1,1}},
{string("#?.##??###????.?????"),{1,7,2,1,1,1}},
{string("?#??##??.?#?#?##??"),{5,7}},
{string("?#???.?#??"),{4,1}},
{string("..??.??#???."),{1,4,1}},
{string("??.????.??"),{1,2,2}},
{string("???.??.??#????"),{1,1,5}},
{string("?..??#?##???#???#"),{1,6,5}},
{string("???#?????????#??"),{4,1,5}},
{string("?#???#?#??.?"),{1,1,1,1}},
{string("???.???.#?.???."),{1,3,2,2}},
{string("????###?..??.?#???."),{7,1,4}},
{string(".??#?.?????"),{4,1,3}},
{string(".#.???????"),{1,3}},
{string("#????##???.?"),{1,5}},
{string("??.???#?????#????"),{2,3,5}},
{string("??#?##?????#"),{7,2}},
{string("???#????#.."),{4,2}},
{string(".????.????#?#????"),{3,1,3,5}},
{string("??.????.???.??#??#??"),{2,1,2,6}},
{string("?????#??#?#?????"),{1,5,3,1}},
{string("??????.#??"),{3,2}},
{string("??#????.?#?."),{4,3}},
{string("???#???????????#?#."),{2,1,3,1,1,3}},
{string("???#.?###???##??#"),{1,1,12}},
{string("?#????#?##.???.?.?#?"),{1,6,2,2}},
{string(".?#??.?#???#???????."),{4,7,1}},
{string("?###???#????##??.?"),{5,2,2,1}},
{string("??#?#????#?#?..??"),{1,1,4,4,1}},
{string("???.#?.??????"),{2,2}},
{string("??#???#???????"),{7,1,3}},
{string("?.?##????#?."),{3,4}},
{string("??.??#???????."),{1,1,4}},
{string("?.?#???????...?????"),{7,2}},
{string("????.???#??.?."),{1,4}},
{string(".#?.?#?#???????"),{1,6}},
{string(".?????###??????????."),{8,3}},
{string("#?.#?#??#??????"),{2,3,2,4}},
{string("#?#?#????.???????"),{6,7}},
{string("??.?#??.#?#?"),{1,2,1,4}},
{string("??.?#???##?###?#"),{1,2,6,1}},
{string("?.??...???"),{2,2}},
{string("#??##?#??.?#???"),{1,3,1,1,2}},
{string("????##?????.??.?.."),{4,1}},
{string(".?###????..?.?#"),{8,2}},
{string(".????#??.#.#??"),{5,1,3}},
{string("??#??.????##..?"),{4,6}},
{string("?#?..???#?????????.?"),{2,1,4,5}},
{string("..??..??#.??"),{1,2}},
{string("?.#?.?.???#?##??????"),{1,2,1,1,5,1}},
{string("??.?##.?..????"),{1,2,1,2}},
{string("??.??????#?.???"),{1,1,4,2}},
{string("???#...??#?#.#"),{1,5,1}},
{string("????.???##?#?.#"),{1,8,1}},
{string(".???#?????.?"),{3,1}},
{string(".##???#.?#??#??."),{3,1,2,3}},
{string("??#??????#???.?"),{2,1,1,3,1}},
{string("???#?.???#???#???"),{2,3,2,2}},
{string("???????#????????????"),{2,2,10,1}},
{string(".???#??.?#??#?#."),{1,1,1,6}},
{string("????##??#?.."),{6,2}},
{string("????###?##?#??"),{4,4,1}},
{string("???#????#????"),{3,7}},
{string("?.?###?.#???#???"),{3,1,3,1}},
{string(".#?.??#?.??#???"),{1,1,2,2,2}},
{string("????#??##?."),{1,5}},
{string("???????#?##.?.#.?"),{2,6,1,1}},
{string("?#?..???.?#?..???"),{2,1,1,3,1}},
{string("??#???#.??.#?#???#"),{1,1,2,2,4,1}},
{string(".#.?#.?#???#?."),{1,1,1,3}},
{string("??.##??.??#.?.?"),{1,4,3,1}},
{string(".?#??.????#"),{4,1}},
{string("???##?#????##?"),{2,10}},
{string("??#???????#?"),{3,1,2}},
{string("##.??#?#??##?"),{2,9}},
{string("?#?#?#?????.???.?.?"),{10,1}},
{string("?..#????#????#?."),{1,1,1,6}},
{string("...?????#???????#"),{9,1,2}},
{string(".???.???.??"),{3,1,1}},
{string("??#.?.????#?#??#???"),{1,1,1,10}},
{string("??.??.#??#?#?.??#??."),{2,7,2}},
{string("??##?#?..??.???"),{7,1,1,1}},
{string("?#????.#.???#.?#.#"),{5,1,4,2,1}},
{string(".?####??#.????"),{8,1,1}},
{string("????..#???????"),{1,1,1,4}},
{string("?.#???#..?????"),{3,1,1,1}},
{string("???##?#??.#?"),{1,2,3,1}},
{string("?????.#???#?.???."),{1,6,3}},
{string(".?.???????."),{1,2}},
{string("#?.?????##?"),{2,6}},
{string("?##????????"),{2,2,1}},
{string("?#.##??##?#"),{2,2,4}},
{string("??#?.#?.#?.?#??#.?#"),{1,1,1,1,5,2}},
{string("????#???????#?.?#.."),{9,2,1}},
{string("?????#.??####?"),{1,2,7}},
{string("#???#??????"),{6,1}},
{string("???#?.????#"),{2,2,1}},
{string(".#.#.#??#??"),{1,1,6}},
{string("?#??##?#????.?..????"),{8,1,2,1}},
{string("?##????????????"),{4,5}},
{string("??#??.#?????##."),{3,1,3}},
{string("???.?#?????????#??.."),{1,1,12}},
{string("??????#?????.?#"),{1,7,1,1}},
{string("??.#????????"),{3,1}},
{string("??.?#?#?.???#???"),{1,3,6}},
{string("?#??#???.??.??#"),{1,1,1,1,1}},
{string("#???#????????.???."),{1,1,3,5,1,1}},
{string("#??..?.#????#?"),{1,1,1,4}},
{string("?????.????"),{3,1}},
{string("??????###?.?"),{1,7,1}},
{string(".#..?##??#??.????"),{1,6,2}},
{string("?##???#?.##"),{6,2}},
{string("?##.??.??#?.???#???"),{3,2,1,1,1,1}},
{string("???##.?#????#???"),{5,1,1,3}},
{string("#.??#??.?#????.???#?"),{1,3,1,6,1,1}},
{string("??#???#.??#.#???"),{7,1,1,1,1}},
{string("#??#?????.?.?"),{7,1,1}},
{string(".?????.?#????..#?#?"),{4,5,3}},
{string("?.?.#??#??.?????"),{4,1}},
{string("#.??#?##?...#."),{1,5,1}},
{string(".??..?.##???"),{1,1,4}},
{string("???#????????#??.?"),{3,8}},
{string("???????##??????"),{2,1,4,1}},
{string("???????.??."),{2,2,1}},
{string("?#.#??##???.????"),{1,1,3,1,1}},
{string("?.?????????."),{1,1,3}},
{string(".???#??#??.#?####?#"),{6,8}},
{string("?.?#??#??.??"),{1,1,2,1}},
{string(".??.???#???????"),{1,6,1}},
{string("??#..#???.??"),{1,1,1,1}},
{string("?...#????.#?"),{1,1}},
{string("??.??.???."),{1,1,1}},
{string("??#?##????.#?.??"),{10,2,1}},
{string("????????.?#????#????"),{2,3,4,2,2}},
{string("???????#?#????.##.?"),{2,8,2}},
{string("??#?????.?."),{4,1}},
{string("??#???.?.??#??????"),{1,1,2,1,5,2}},
{string(".??.????#?#?#??"),{1,1,3,2}},
{string("#???.??.#??##?????.?"),{1,1,1,1,5,1}},
{string("##??#?????#??????#??"),{5,12}},
{string(".?#????..??#?#????."),{5,7}},
{string("????#.?????.?.?#?"),{4,1,3}},
{string(".#..?#?????.?#"),{1,5,2}},
{string("??????.?????#"),{3,1,1}},
{string("?#?????.???"),{1,3,1}},
{string("#.??##???##?.???##?"),{1,10,2,2}},
{string("??#???..#?#?"),{4,1,1,2}},
{string(".?.#?.?.???."),{1,1,1,1}},
{string(".#?.#.#??.??????"),{1,1,2,1,2}},
{string("?#??.?#????#."),{2,6}},
{string("??????##??."),{1,2,1}},
{string("???????.??.????.??"),{1,1,1,2,4,1}},
{string("?#??????#??###.#.??"),{3,10,1,1}},
{string("..???#?????#?#?#?"),{3,7}},
{string("?..#????????."),{1,1,4}},
{string("?#??#?#.??"),{1,4,1}},
{string("???##??##?.?"),{2,2,3,1}},
{string("#??#####???#.???"),{8,2,1}},
{string("??#?.????.?"),{3,1}},
{string("...????#??"),{1,4}},
{string(".?#?????###?##.?"),{3,4,2}},
{string("????#.????##???"),{1,4}},
{string("?##??????.##"),{2,1,2}},
{string(".?..?#.????#?????"),{1,1,8}},
{string(".#?#?.?.???..?"),{4,3}},
{string("??#??????#?#."),{1,1,5}},
{string("#?????#?###????#???"),{1,9,1,2,1}},
{string("???????###??.??.?"),{1,1,8,1,1}},
{string(".??.???#?#.#??.?#.#"),{1,6,1,1,1,1}},
{string("???#????????."),{5,4}},
{string(".?##??????????"),{7,4}},
{string("?????.??.?#??"),{5,1,2,1}},
{string("#.????????##"),{1,1,3,3}},
{string("???#????.????##.??"),{7,5}},
{string(".#?.??#??##???"),{2,7}},
{string("#?..??#?#..???#"),{2,4,1,1}},
{string("??#..??#??#????#????"),{1,1,1,4,4}},
{string("??????????????."),{2,1,1,4,1}},
{string("#??#???.?#."),{4,2,2}},
{string("#.??#???#??.?#??.??"),{1,8,1,1}},
{string("??.???#?????#??????"),{1,2,3,3,5}},
{string("????.#..???#??#?#?"),{1,1,1,7}},
{string(".#?????.???????.#"),{3,1,2,2,1}},
{string("???##??.?#??.??"),{5,2,1,1}},
{string("????.?##????#"),{2,2,3}},
{string("??????#.?#??"),{1,2,2,1}},
{string("##?.#.#??????#??"),{3,1,1,7}},
{string("?????.?????#????????"),{6,1}},
{string(".?.???##????."),{4,2}},
{string("????#????#??????"),{1,6,1,2}},
{string("??#?##??????##?#???"),{1,7,7}},
{string("?..???#.??.?"),{2,1,1}},
{string("#?????#.??.?#.????"),{1,5,1,2,1}},
{string("???##?#??..??.?#??"),{3,3,2,2}},
{string("?#??.??#?.?"),{2,4}},
{string("?????????#??#??????"),{1,1,7,2}},
{string("???#????#???#?#?."),{1,7,6}},
{string("?????#?..??#????#???"),{4,4,5}},
{string("#?#????????????"),{3,4,1,1,1}},
{string("???#????#.#.????"),{1,3,1,1,2}},
{string("??.??#???#.??"),{2,3,1,1}},
{string("?????.??##???.??.??"),{1,7,2}},
{string(".??#???????##???"),{1,10}},
{string("?###????#????#??#"),{4,1,3,4}},
{string(".?????.?.??."),{3,2}},
{string("?.?.?#??.??"),{1,2}},
{string("#?????#???#?"),{7,2}},
{string("??#??????.?#???#?#??"),{5,8}},
{string("????#??.????#.???#?"),{1,4,3,1,1,2}},
{string("???#??.????"),{4,1}},
{string("?#?????#?#."),{3,3}},
{string("#.?????#?.????#?#"),{1,6,4,1}},
{string("??#??..#????."),{2,1,2,2}},
{string("#?????#??#.???????"),{2,3,1,3,1}},
{string("?????###?#?.??#??"),{7,1}},
{string("###???????.??"),{4,2,2}},
{string("??#..??###"),{3,5}},
{string("?.##.#??????"),{1,2,1,3}},
{string("??#?#?.#?.#????"),{1,4,1,3,1}},
{string(".??????????"),{1,2}},
{string(".????.#??#???##?#"),{1,1,1,2,5}},
{string("?????##?????????."),{4,5}},
{string("???..???#?.#.?#?#??"),{5,1,5}},
{string("???.???????##???.??"),{1,1,2,1,5,2}},
{string("??.????#??##??????"),{1,9,2,1}},
{string("#?#???#?###???#??##."),{1,10,5}},
{string("????##????##?..?#"),{2,4,2,1}},
{string("##??..?#???????.?"),{3,5,1,1}},
{string("??##.?#????#??#.?#"),{4,10,1}},
{string("?????????????"),{1,1,1,1}},
{string("?.????#.?.#?.?"),{1,5,2}},
{string(".?.#??.#...##???.??"),{1,3,1,2,2,1}},
{string("??##.??..?#?#"),{2,2,3}},
{string(".?.#????#??#?"),{2,6}},
{string(".???????#??#.???.?"),{1,7,1,1}},
{string("??.????????"),{1,3}},
{string("??.??#?.?????##??.??"),{1,3,6}},
{string("????.?????#?##??.?"),{3,11,1}},
{string("???..????#.##?"),{1,2,1,3}},
{string(".??#???.???."),{3,1,1}},
{string("??.???..?##???.."),{2,2,4}},
{string("???.#??##????????"),{1,1,4,1,1}},
{string(".?..??????"),{1,1,3}},
{string("??#???..????"),{5,2,1}},
{string("?????##??#??????#?"),{1,9,1,1}},
{string("??.?????.??????#"),{1,5,1,1,1}},
{string("??????#???."),{1,1,5}},
{string(".?????###..?.#?."),{1,1,4,1,1}},
{string("????#?#.???##?"),{1,3,1,5}},
{string("?.?..????###??.."),{1,5}},
{string("???.#????."),{3,1}},
{string(".#?#?.#?#?.???#"),{1,2,3,4}},
{string("????#??#??#?#????"),{2,7,2}},
{string(".?.???#?#??##???#"),{1,13}},
{string("#??#???#..?#??#?????"),{1,6,5,4}},
{string("#???????#??"),{4,5}},
{string(".??#??????.??#"),{2,1,1,3}},
{string("??#????.?.#"),{2,1,1}},
{string(".#??##?#.#?..???#"),{7,1,3}},
{string("..?#??????##??.?"),{3,1,4}},
{string("#??#??#??.?#."),{1,5,1,1}},
{string(".???#????.#?#?"),{6,4}},
{string(".??#???#?.???????"),{3,1,2,3}},
{string("????????.#?#.#"),{1,3,3,1}},
{string("??.?#????#??????????"),{1,11,1,1}},
{string("..??#?.???#?.?.?."),{3,1,1,1}},
{string("?#?????##??##.#"),{2,8,1}},
{string("????#???#???????"),{2,1,6,1}},
{string("#???.?##???#?##"),{1,1,4,2,2}},
{string("?????#??##?#??#"),{11,1}},
{string("?.?#.#????#?#?#?#?"),{1,1,3,2,5}},
{string("##???.????.????"),{3,1,1,2}},
{string("???..##?.??..#?"),{2,3,1}},
{string("???#??#?.??.?????"),{6,1}},
{string("?.?#??.????#??#?#??"),{2,7}},
{string(".?#????.??#??#???#?"),{6,2,2,1}},
{string("???.?#???.?"),{1,4,1}},
{string("?##.????####?"),{2,6}},
{string("###??????#?#?"),{5,3}},
{string("?.#??#.?..##??????"),{4,6,1}},
{string("?.#.#.???#?##???????"),{1,1,1,10,1}},
{string("??.?#?????#"),{3,2,1}},
{string("??#????#?#??"),{2,3,1,1}},
{string("?#?.??#.???"),{1,3,1}},
{string("????.?#???#?#?????"),{2,1,2,3,1,3}},
{string("????#?.??#????.#?"),{1,1,5,1}},
{string("????????#??#??#?#?"),{1,1,1,1,5,2}},
{string("???.??????#?"),{1,2,4}},
{string("????.??#???#"),{1,5}},
{string("?????????#??????????"),{2,10,2,1}},
{string("??????#??.."),{2,3}},
{string("?????#.?#??#??"),{3,1,5,1}},
{string("?????#??#?..??"),{3,4,1}},
{string("??#???#???#???.?.?#?"),{3,10,1,1}},
{string("#?##??????#???????."),{7,1,3}},
{string("??#??????.?##??##???"),{7,7}},
{string("??????##?#??????"),{1,8,1}},
{string(".????#??#???????."),{7,3}},
{string("?#?###???..."),{5,1}},
{string(".?#??????.?????"),{1,2}},
{string("?.?#?????#.???#??"),{1,5,1,3,1}},
{string("????#?????#??#??."),{5,2,2,1,1}},
{string(".?.?#?#???#??."),{1,5,1}},
{string("???.????#??##??"),{1,8}},
{string("#???.????#????????"),{2,8}},
{string("??.##?#?#??"),{1,6,1}},
{string("?????????#..?#?#?..#"),{9,4,1}},
{string("??????..?.???#.#??"),{2,4,1}},
{string("?.#.?#????."),{1,1,2}},
{string("?##???#?????##?.???#"),{3,5,4,1,1}},
{string("#??#?#.?????#??#?##?"),{1,1,1,1,7}},
{string(".?.????#???#???????"),{1,1,1,2,6,1}},
{string("??????????###??"),{2,7}},
{string("#??????#?###??????"),{1,10,2,1}},
{string("#??.?.??#?#?"),{2,1,5}},
{string(".#..?????#?.??"),{1,1,4,2}},
{string("#?...#?.#???#?"),{2,1,1,3}},
{string("###?#??##???????#??"),{14,1}},
{string("??#?.?#????#??#?????"),{2,11,1}},
{string("???...??.#?#?."),{2,1,4}},
{string("#??.#??#????#??"),{1,4,6}},
{string("???.#.??#?#???.?##."),{1,1,1,6,3}},
{string("???????..?????#???"),{1,1,1,1,6,2}},
{string("???##????.????#..?."),{5,2}},
{string(".???#?.?????#."),{4,2,1}},
{string(".??????????#.#?"),{1,1,5,1}},
{string("????.?.??#?##????"),{2,6}},
{string("#?.?#?.????#.?????#"),{1,2,1,1,1,4}},
{string("?#.?#??????#?"),{1,9}},
{string("??#?#???#?#?????.?#?"),{7,1,1,1,1}},
{string("...?##?#.????."),{4,1}},
{string("?????????.#?"),{3,2}},
{string("?.#?#?????#??"),{5,1,1}},
{string("?###.???#?."),{3,2}},
{string("?.???#.????#??"),{2,6}},
{string("???.??..???#??."),{1,2,5}},
{string("?#..?#?????##???."),{2,9,1}},
{string("#?.??###?#?#??.????."),{2,8,1,2}},
{string("???#?.????.???????"),{4,4,6}},
{string("???#?????#?#?.#"),{2,1,5,1}},
{string(".?????#???#???"),{1,2,4}},
{string("???##???????"),{6,2}},
{string("???????#.????#???"),{6,1,2}},
{string("????????#???.?#??##"),{1,1,1,1,1,6}},
{string("?#?.?#??#?"),{2,2,2}},
{string("#..?.?#.???????#????"),{1,1,1,1,1,5}},
{string("???.?.????"),{2,1}},
{string("#???..???#??.??#.??"),{1,1,2,3,1,1}},
{string("???#..##?#???#?"),{3,4,1}},
{string("??.#?????????????"),{7,3,1}},
{string("?..?.??????"),{1,1}},
{string("?#????..#.#?????"),{2,1,1,1,2}},
{string(".?.????????????"),{1,1,1,4,1}},
{string("?.????????#?"),{2,3}},
{string("#?????#..???#?"),{1,3,1,1}},
{string("???.?????##."),{3,2}},
{string("?.??????#??.???#???"),{4,1}},
{string(".?????#??#???#?#?."),{8,4}},
{string("???..?##??.#"),{1,1,3,1}},
{string("???.??#??#?##"),{1,7}},
{string("????.#??#????."),{1,5}},
{string("#?..????.#??.??"),{2,3,3}},
{string("???????##?????????#"),{3,1,9,2}},
{string("#??##?#??#.?#?"),{2,2,4,2}},
{string("?.?#?#?????."),{1,1,3,1}},
{string("?#???#???????"),{6,2,1}},
{string("?????..?.#?."),{1,1,1,2}},
{string("?????.?#??#??."),{1,5}},
{string("??#??#.#??"),{2,1,1}},
{string("..?..#.#??##?#..#?"),{1,1,7,2}},
{string("??????##?#?.??#???"),{1,1,2,1,5}},
{string("?#??#?#??.??.???"),{2,2,2,1,1}},
{string("??...??#?#?#????."),{1,8}},
{string("???#???#?#"),{1,2,4}},
{string("?#??..??.?#.?"),{2,2}},
{string("#??#??#???"),{1,6}},
{string("?????...???##??????"),{1,2,5,2}},
{string("?#..#?????#???#..?"),{1,11}},
{string("??????.????.##"),{2,1,2,2}},
{string("??#????#??##??????."),{1,9,1,2}},
{string("#??###???..????"),{6,1,2}},
{string("????????????#??.????"),{9,2,1,1}},
{string("??#????????"),{4,1,1}},
{string("?#????#.??#?????"),{4,1,1,1,2}},
{string("?#..?#?????????#??"),{2,3,1,1,1,2}},
{string(".???????#??.?"),{2,6,1}},
{string("???#?????#?????#??#?"),{1,8,1,4}},
{string("?#?.???.???"),{1,3,1}},
{string(".??????...??.??#?.??"),{5,1}},
{string("??.?#????#???##???.?"),{2,1,11}},
{string("???#?.???#.#.?"),{4,4,1}},
{string("#?###?????#.????"),{1,4,1,1,1}},
{string(".???.?????.????"),{1,1,2,1,1}},
{string("???#??#????.???"),{4,3,1}},
{string("????.?????#??"),{1,1,5}},
{string("??##??.?..??????"),{1,3,1,1,1}},
{string("????????..#?."),{7,2}},
{string(".????##??..?"),{1,3,1,1}},
{string(".##?#??.#?#?#???"),{5,1,1,2,1}},
{string(".????##?.???????"),{2,3}},
{string("?#?#??.?.."),{4,1}},
{string("?????????#?.???"),{1,6,1,1}},
{string("????#?#.???."),{7,3}},
{string("?????#??#?##?????.#?"),{12,2,1}},
{string("???#??#?.?#????#??"),{7,7}},
{string(".#.?.????????#."),{1,2,1,1,1}},
{string(".??.????##"),{1,5}},
{string("????#??.?#????.."),{2,1,4,1}},
{string(".???#??????#????????"),{1,1,11}},
{string(".?.???.???#?#."),{1,1,2,1}},
{string("??#????#??#????.."),{6,5}},
{string("#?##?.?#???#?"),{4,6}},
{string("????#????????????"),{1,2,1,1,4}},
{string("??????#??.????????"),{1,1,3,3,1}},
{string("?????.###??#??"),{1,1,8}},
{string("??##?.?????.?"),{4,2}},
{string("?#.??.????"),{2,1,2}},
{string("??#????.??#????."),{4,1,3,1}},
{string(".?????#?##??."),{1,7}},
{string("?###.??#?????."),{3,4}},
{string("??#????##?##???.??"),{4,6}},
{string("????#?#????#???#???"),{5,7}},
{string("?#??#?????"),{2,1,4}},
{string("#?#??.??#???.?"),{5,2,1}},
{string("?#?#??????"),{3,1,1}},
{string("?#?#??.????#?"),{5,6}},
{string("????.???#.???#"),{1,1,1,4}},
{string("?#????.????.???"),{4,3,2}},
{string(".???.?.????#??##?.?"),{1,9,1}},
{string("???.???#???.????#??"),{1,1,7,2,1,1}},
{string("?#??????.?#?"),{2,1,1,1}},
{string(".???#.???#??"),{3,4}},
{string("???#??#???"),{2,1}},
{string("???#?#?#?."),{3,1,1}},
{string("##????????"),{4,1}},
{string("?.?#???.##?"),{1,3,2}},
{string(".???.?.?#?????"),{1,1,1,3}},
{string("??#?..???????"),{2,1,1,1}},
{string(".#.??#?..?"),{1,3}},
{string("?.???#????."),{1,3}},
{string("????????#?#???"),{5,1,1,1}},
{string("??#??????.?#???..?"),{4,1,1,1,1,1}},
{string("??????.???##?"),{1,2,1,4}},
{string("???????#????????"),{1,12}},
{string("..??..?#????###?.?"),{1,10}},
{string("?????#?#??#?.??#?#?"),{1,1,7,1,1,1}},
{string(".?#????.??#??"),{6,1}},
{string("?#???..??????#?."),{1,2,1,6}},
{string("??.?#??#?##????#?#."),{1,2,11}},
{string("??#??.???#?#??#?#."),{4,1,5,1,1}},
{string(".#.?????#?????"),{1,1,7}},
{string("????#.????#?#?#?#"),{1,1,9}},
{string("#?.???#???.?#.?#?"),{2,4,1,2,1}},
{string(".???...???."),{3,1,1}},
{string("..?.???##?..??#???."),{2,3}},
{string("##?#?????????.??#"),{5,1,4,1,1}},
{string("?#????.?.??####"),{2,1,1,1,5}},
{string("?#????#?#."),{1,2,1}},
{string("?##?#??????#???????#"),{8,1,1,1,1}},
{string("?.??????#####??"),{2,7}},
{string("#????#?????#????.??#"),{10,5,2}},
{string("???#?....#?"),{3,1}},
{string(".?#???.???###?????"),{2,7,3}},
{string(".??????????????##"),{8,2,4}},
{string("?????????.#?#??."),{4,4}},
{string("?????????.?###???"),{1,2,3,5,1}},
{string("??#??##.?????."),{6,2}},
{string("..?.?##.???"),{1,2,1}},
{string("?.?.????.#?"),{1,3,2}},
{string("?#????????????.???"),{2,4,3,2}},
{string(".??..??.?.?#???????"),{2,1,8}},
{string("#????.?.#?????#"),{5,1,4}},
{string("?#????.?#??#.?.?"),{2,5,1}},
{string("??##???#???.??#.?"),{1,6,1,1,1}},
{string(".???????##???#?.."),{1,10}},
{string("?????.?..???..?"),{3,1,1,1,1}},
{string("??.????.???.?#."),{1,3,3,2}},
{string("???????.#?"),{1,1,1}},
{string("?.??#??????#???"),{5,4,2}},
{string(".???#?????#.?"),{1,3,1,2}},
{string("?#??#??.?????#?#??#?"),{5,1,1,1,1,3}},
{string("#.?#?????#??#???"),{1,9,1,1}},
{string("???..????#?#???#."),{1,1,2,7}},
{string(".??#?#?#??#?.?###??"),{2,3,3,3}},
{string("??????#?.????#"),{3,2,2}},
{string("#?##?#??#?##?"),{1,10}},
{string("?#??#.????#?##?"),{4,7}},
{string("??????#???#?..?#"),{7,1,1}},
{string("?????.?.?#??"),{1,1,1,1}},
{string(".???#?????#.?#?#?.?"),{5,2,1,1}},
{string("??.?#.????#?"),{1,2,1,1}},
{string("????#?#???????"),{2,6,1,1}},
{string("?.????????#?"),{1,3,1,2}},
{string("????????.#?#??"),{5,3}},
{string("??????#??.?"),{3,1}},
{string("...?#?????#??.?#"),{3,5,2}},
{string("?##?#????.??##?.?"),{6,1,4}},
{string("#?.?.??##?#?"),{1,1,5}},
{string("????#?#???#?????#."),{1,5,1,2,1}},
{string("##?#?#??.??.?????"),{8,1,1,1,1}},
{string("??#?#?????????#????"),{11,1,1}},
{string("??#.#???#???#?????"),{2,3,1,3,2}},
{string("?.??#?.??.???."),{1,3,1,1}},
{string("?#????#??????"),{1,5,3}},
{string("?#.?.??#?.?#???#"),{1,1,6}},
{string(".??????.?#????????"),{1,1,2,1,4}},
{string("?#??.??.??.?"),{1,1,1,1}},
{string("?#?##?#?????##?..##"),{9,1,3,2}},
{string("????.?#.???????.#"),{1,2,1,4,1}},
{string(".????.???#?##?"),{1,1,4}},
{string("?#?.?????#?..##?"),{1,2,2,3}},
{string("?#?#?.?#????#."),{3,2,2,1}},
{string("#.??#?#????"),{1,3,1}},
{string("???..##??.?"),{1,2,1}},
{string("???##????.?????????#"),{9,1,3,2}},
{string("####???.???#???#?"),{6,1,4,1}},
{string(".?#???????#."),{2,1,1,1}},
{string(".???????????"),{1,1,2,1}},
{string("#?##?#??##??"),{6,3}},
{string("..?.???.?."),{1,3,1}},
{string("?..?.?#??????.???.?"),{1,1,3,1,3,1}},
{string(".???.#???#??.?"),{1,7,1}},
{string("?##?.??##?.?????"),{4,4,2}},
{string("?.#####???#?????"),{7,4}},
{string("????#??.?##??"),{3,2,1}},
{string("??#.????.?#???##?#?"),{1,1,1,3,3,1}},
{string(".????..??#?#?##?#???"),{1,13}},
{string("?.???.????#??????"),{1,1,6,2}},
{string("..??.?????????????.."),{1,2}},
{string("?.????#.?#??"),{2,1,1,1}},
{string("???..#??#?.?"),{1,1,2,1}},
{string("??????.??#."),{1,3,2}},
{string("??#??#..#?."),{3,1,1}},
{string(".?..???#??#."),{1,4,2}},
{string("?.#.????.?"),{1,1,1}},
{string("?#?????.?.??.???#???"),{4,1,4}},
{string("?????#?#.??.?"),{4,3,1}},
{string("#?#??????##??#?#???."),{4,2,5,1,1}},
{string("????#?????#??##"),{2,3,3,2}},
{string("?.???????.?????"),{1,2,1,1,4}},
{string(".???.?.??#.#??"),{1,1,2,2}},
{string("?###?##?#?????..??"),{10,1}},
{string("???????#?????.#.??.#"),{6,1,1,1,1,1}},
{string("??.????#??????."),{4,1}},
{string("?#???#.??#?."),{3,1,2}},
{string("?##?#..?#?..??.."),{5,3,1}},
{string(".####?#???.?.?#?..."),{8,3}},
{string("????#?#????#??#?????"),{1,11,1,1,1}},
{string("????.??????#????"),{2,2,2,4}},
{string("?.#???#?#??."),{1,4}},
{string("??#???????#??...???"),{4,1,3,1,2}},
{string("??.???#???#???#??.?"),{1,3,5}},
{string("????#?..??"),{3,1}},
{string(".????#??.?.??"),{3,1,1}},
{string("??#?##????."),{1,4}},
{string("?#?..?????????#?."),{1,10}},
{string("#??##??..#.#?"),{7,1,2}},
{string("???###?????.???##"),{1,8,1,2}},
{string("#??#??.?????????..?"),{1,1,9,1}},
{string("????#?????#???.??"),{12,2}},
{string("?.????.?##????.??"),{1,3,3,1,1}},
{string("???##..????.?"),{1,2,4,1}},
{string("#?#??.???.??#?#??"),{1,3,1,5}},
{string("??#?#???????????"),{1,8,1,2}},
{string("#?????#??."),{3,3}},
{string(".????##??.?????"),{1,4,1,2}},
{string("????#??????..??.#"),{9,1,1,1}},
{string(".??????.#.#?"),{1,1,1,1}},
{string("?.??.#??.??.??#.?.?"),{2,3,1,3,1,1}},
{string("????##???##???#?#?"),{1,9,3}},
{string(".???.??.?#"),{1,1,1}},
{string("???#?????#??."),{3,1,2}},
{string("??????#.??????###.?"),{6,4,3}},
{string("?#?.???#???.?#..??"),{1,1,4,2,2}},
{string("??.?????.???###.???"),{2,2,1,5,2}},
{string("?###????#??"),{3,3}},
{string("?????##?.?#?##???."),{7,6}},
{string("???#???##?????"),{3,4,1}},
{string("..?????.?##????.??.."),{4,7}},
{string(".?...???#?"),{1,3}},
{string("??##??#????.#???????"),{3,1,1,6}},
{string("?..?.#?????#?"),{1,1,2,1}},
{string("???.??#????"),{1,5}},
{string(".?#??#???????????"),{1,3,1,1,1}},
{string("????#?#?.?#?"),{7,1}},
{string("?.???#??????.."),{5,1}},
{string("?#???.????.?#???"),{1,1,1,1,5}},
{string("?##????.?."),{2,1,1}},
{string("?#.?.##???"),{1,3}},
{string("?#??????.?..?.???."),{1,2}},
{string("#?????????#??#????"),{5,1,8}},
{string("???#.????.???"),{1,1,2,1}},
{string("????#??.##?"),{1,1,2}},
{string("???????#??#?"),{1,8}},
{string("?????.?????."),{2,1,1,1}},
{string("????.?#?###?.?#???."),{2,7,2,1}},
{string("???.##????????????."),{2,3,7}},
{string("#???#?????"),{3,1,1}},
{string("???##???##???#"),{1,3,3,1}},
{string("#???????#.?.?.??"),{9,1,2}},
{string("?#?????##???????"),{3,10}},
{string("???...?????###??"),{1,7}},
{string("???.??#?##?#?"),{1,1,2,1}},
{string("#.?#???#?????#."),{1,7,1,1}},
{string("#???????????"),{3,3,1}},
{string(".???.?.#?????#"),{1,7}},
{string("?###???#??#?.?#?????"),{12,1,1,1}},
{string(".??????#????.???"),{6,1}},
{string("?#?.##?##??.?"),{2,7}},
{string("???..??...??."),{1,1,2}},
{string("??#??#?#???#???????."),{7,4,3}},
{string("??.??#????."),{2,7}},
{string(".?#?.????#??#.??"),{2,7,1}},
{string("?.#.??#??#???.??"),{1,1,8,1}},
{string("????#??#?#.??.?.####"),{10,1,1,4}},
{string(".?#??????.?.????"),{8,2}},
{string("??#?.??.??"),{2,2}},
{string("??????.??????##??"),{4,4,5}},
{string("?#??#?.?#?"),{3,1,3}},
{string("???###????..????..?"),{7,4}},
{string("??.???????#?.?"),{2,5,1,1}},
{string("?#.?#??????"),{1,3,1}},
{string("?#??.??..##?.???#.?"),{4,1,2,1,1,1}},
{string("??????#????#?#??.??."),{1,3,8,2}},
{string("??????#?#????"),{6,3}},
{string("?????##????#?##?"),{2,3,1,5}},
{string("??#??#??####??.??##?"),{12,4}},
{string("..???##??#?#??.?."),{10,1}},
{string("?.?????##????"),{7,1}},
{string(".????#??#?##????.#?"),{2,11,2}},
{string("?????...?.##?##?"),{3,1,6}},
{string("?????#????.?"),{1,7,1}},
{string("?#???#?#??"),{3,1,2}},
{string("??#????????.?#??"),{1,4,2,1}},
{string("?????#?#???"),{1,6}},
{string("?...?#??..???????.?"),{1,4}},
{string("??.???##?#??##?.???"),{1,1,10,1,1}},
{string("???#?.?.??#?#?#"),{1,1,1,7}},
{string("?#?..???##??"),{3,1,4}},
{string("??.??.?#????##?.??#."),{1,1,9,2}},
{string("???????????"),{2,1,2}},
{string("..???????#?"),{1,2,1}},
{string("##??##?.?."),{2,2}},
{string("??###??.????#?"),{3,1,1,3}},
{string("?..???#?.?"),{1,5,1}},
{string(".#??????.#?."),{1,1,2,1}},
{string(".????#??????????.?"),{1,5,1,1,2}},
{string("????#????...??????#?"),{3,1,3,3,3}},
{string(".??????.??."),{3,1,1}},
{string("????#?#????#??#???"),{1,1,1,2,2,1}},
{string("???..#????.?"),{1,1,1,1}},
{string("?##??##?#.?#?.??."),{4,4,2,2}},
{string("..??????##????"),{3,4}},
{string("????.?.??#???"),{3,1,2,1}},
{string("???????.?."),{1,1,1}},
{string("..#?.?##?#????##??"),{2,11,1}},
{string("??????????#???."),{3,6}},
{string(".?????.??.?#??#"),{1,1,1,2,4}},
{string("?.???????."),{1,1,1}},
{string("???#??????#?##"),{4,1,1,2}},
{string(".?...?????.????"),{1,4,2}},
{string("?##??#?????..?.?"),{9,1}},
{string("??.??#????#?.#??#??"),{2,6,1,2}},
{string(".?..#??#??#.?#?##?.#"),{1,1,4,4,1}},
{string("??.?#??.#?"),{1,2,2}},
{string(".#??..???#."),{1,3}},
{string("???##.#?.??"),{4,2,1}},
{string("?.#??????.?##"),{2,1,3}},
{string("##????.?##?#??????"),{2,1,1,6,1,1}},
{string("#..???#???#??#???#?."),{1,6,1,1,1,1}},
{string("?.??.?#?#?.#"),{1,2,1,1}},
{string("..##?????.##"),{5,2}},
{string("??##..???#?##?????"),{1,2,8,3}},
{string(".??#?##?#?#?#??."),{10,1}},
{string("#??##?#??.??.#?"),{8,2,1}},
{string("????...??#?#?#??.???"),{2,8,3}},
{string("??..#.??#???.?#???"),{1,1,4,1,1,1}},
{string("???.?????.???.?#"),{3,1,1,1,1}},
{string(".??###.?#????."),{3,3}},
{string("##?#??.??..?##?."),{4,1,1,4}},
{string("##????.??#??????.???"),{6,3,1,2,1}},
{string("?#?#?#?#??????"),{1,1,1,5}},
{string(".????##????."),{2,6}},
{string("#???##???????.??????"),{10,1,1,1}},
{string("?#??.##?#??"),{3,2,2}},
{string("?#?????.#??##"),{1,2,2,2}},
{string(".?????????#??#?.??"),{1,1,9,1}},
{string("???????##?#?"),{1,1,4,2}},
{string("??#?.??????.??#??#?"),{4,1,1,1,1,5}},
{string("?#????.????"),{3,1,1}},
{string("??.?#??##?"),{1,2,3}},
{string(".????????.?"),{1,1}},
{string("???.???#?##?#?#??##"),{1,2,9,2}},
{string("?????#?##.?##"),{3,4,3}},
{string("#?????????"),{1,2,2}},
{string("?#..?#?.?#..??##????"),{2,1,2,1,3,1}},
{string("..??????????#?#?????"),{2,4,5,1,2}},
{string("??#?#?...????????"),{3,2}},
{string("??#.##??##??????"),{1,1,2,2,4}},
{string("?#?.??.???#?#"),{2,1,1,1}},
{string(".##.???#???#.?.?"),{2,1,2,1,1}},
{string("#???#???#????#??#."),{1,1,1,4,5}},
{string("?#?.????.?"),{1,1,1}},
{string("#?????..?."),{1,1,1}},
{string("??.?#???.??#?"),{2,1,2,3}},
{string("..??.?#???##?#??#?#?"),{1,14}},
{string("?.?#??#????##????##?"),{6,3,5}},
{string("????..?.?.???###??."),{1,1,1,1,5,1}},
{string("?.??#?.??.?##?#####"),{1,8}},
{string("?.?#?????.???"),{5,1}},
{string("???.##??????????"),{2,2,2,1,2}},
{string("?.##????##???????#.."),{2,11}},
{string("#???????#??#????"),{1,1,1,6,1}},
{string("#????#??????#"),{1,1,5}},
{string("??.#??#???..##??#?#?"),{1,6,7}},
{string("#??##?????????###?.."),{6,7}},
{string(".???????..#?.#??.?"),{2,2,1,2,3}},
{string("????????#?#???#???"),{11,1,1}},
{string("??..??.?????"),{2,1,1,3}},
{string("?.??#??#???"),{1,1,2}},
{string("??.??##?#.?#??#?.???"),{1,6,5,1,1}},
{string(".#?#?#??#?#??????"),{10,1,1}},
{string("????????????#."),{6,1,2}},
{string("??.??##???.???"),{5,1}},
{string(".??????#???###?.?"),{1,1,1,4,1}},
{string("#.??#???#????????."),{1,4,5,1}},
{string("##?##?????#???#??#??"),{15,1,1}},
{string(".????#?#?#???"),{2,1,5}},
{string("??###??.??"),{4,1}},
{string("??#?#??.??"),{4,1}},
{string("??.????.#.??#???"),{2,1,4}},
{string("?????..???#?.??"),{1,1,1,3,1}},
{string("?.#???????????#???#"),{5,1,3,3}},
{string(".???????????.??"),{2,6}},
{string("??#?????#.?#?????"),{8,4}},
{string("??#...#????"),{1,3}},
{string("?.??.#??.####?"),{2,3,4}},
{string("#?????#?????#??#?."),{1,1,1,1,3,1}},
{string("????#????###"),{2,8}},
{string("?????..??."),{2,2}},
{string("?.??#..???#?##??"),{3,7}},
{string("?##????##??#."),{2,1,4,1}},
{string(".#?????????##?.?#..#"),{1,3,1,4,1,1}},
{string("?#?#??#????.#.#??."),{1,1,3,1,1,1}},
{string("??#???.??????#?.."),{2,1,3,3}},
{string("#?##???#????#."),{1,11}},
{string("??..?..????#???#"),{1,1,1,3,2}},
{string("??#?.?#?#?"),{3,4}},
{string("??#???#??#?#"),{3,3,1,1}},
{string("#.?..?##?#????#??##?"),{1,1,3,4,1,2}},
{string("???????#?.?????#??"),{6,7}},
{string("?#??#??.?????#."),{5,6}},
{string("?.??..???#?..??.???"),{3,1}},
{string("?#??#???#?"),{1,1,2}},
{string("?.??##???????????"),{10,3}},
{string("##?..#???#?.??"),{3,3,2,1}},
{string("??#???..?#????"),{5,6}},
{string("?#?.??#???.??#??"),{3,3,1,1}},
{string(".#???????.#????##?."),{3,3,7}},
{string("?.??##??..??"),{3,2}},
{string("?#??.???.???.?#?"),{4,1,1,2}},
{string("?##?.#??#??"),{2,1,2}},
{string(".???#?.???????##.??"),{2,3}},
{string("?#??#??.?.????..??"),{1,4,1,1,1,1}},
{string("?.????????."),{1,6,1}},
{string("?????##?#????.#."),{8,1,1}},
{string("?..?????????????????"),{1,11,1,1}},
{string("..?#?????#...?"),{1,3}},
{string("?.?#???#.??"),{2,2,1}},
{string("##??.???.??"),{3,1,1}},
{string("???##??.?.#?"),{5,1}},
{string("??.?..#??.?.?"),{1,3}},
{string(".???.?##?????????"),{3,11}},
{string("#..?#???#??.????"),{1,8,2}},
{string(".??????.?.?.????#?#?"),{5,1,2,5}},
{string(".?????#???#???..???"),{5,3,1,2}},
{string("?????#????.?"),{8,1}},
{string(".??#.??????##?.."),{1,9}},
{string("#???#?#..??#?#???#"),{1,1,1,1,7,1}},
{string("#.?#??##???#."),{1,1,2,1}},
{string(".??????.?#????"),{4,5}},
{string("???##?.??????.#.??.?"),{3,6,1,1}},
{string("????.#???????"),{1,4,1}},
{string("??##?.????"),{3,1}},
{string(".??##?????#?#???#?"),{1,4,6,1}},
{string("??#?####?##?.??#?#?"),{12,3}},
{string("#.?.??##?#.?????"),{1,1,4,1,1}},
{string("???????..#"),{1,1}},
{string("?????#??????#."),{2,5,4}},
{string("??#???#???.??#?"),{7,1,1,1}},
{string("??????.?###."),{2,4}},
{string("?#.??#??#????."),{1,8}},
{string("???#???##??#??"),{1,9,1}},
{string("??###??????????"),{11,2}},
{string("??...??.#?#??#??."),{2,1,1,1,3}},
{string("???.????#??.?."),{3,1,2,1}},
{string("??###??#????."),{1,3,2,2}},
{string("??#???????##??"),{4,1,5}},
{string("?#????????#.???"),{1,7,1,1}},
{string("???#???#?????#"),{1,1,7}},
{string("?????.??.??????"),{2,1,2,1}},
{string("??????#?#??#?.??"),{1,1,3,1,1}},
{string("?##?#??#?.#?"),{2,1,1,1}},
{string("?.???.??.???????"),{1,1,2,2}},
{string("????????..???#?"),{1,1,1,1,2}},
{string("??????.##?.?###?????"),{5,3,3,2}},
{string("#???????##"),{1,1,5}},
{string("???.??#??#??#.#"),{2,1,1,5,1}},
{string("???#????.#?#?"),{4,2,3}},
{string("??.#??##?????"),{2,7,1}},
{string("???#?.?.??????"),{5,1,2,1}},
{string("???.????.?"),{1,1,1}},
{string("???????##???????."),{1,8,1}},
{string("??.?#???.#??#??"),{1,1,2,2,1}},
{string("?.???????.??#??#?.??"),{7,6}},
{string("?????..?#???."),{2,3}},
{string("???##??#??.??"),{9,1}},
{string("??#?##??#??.???#??"),{11,5}},
{string("????????#??#??#"),{4,9}},
{string(".??.?.????"),{1,1,1}},
{string("??????##.????"),{3,3,2,1}},
{string("????????#???#??#????"),{1,11}},
{string("#.????#?????#?#????"),{1,1,1,4,5,1}},
{string("??..????????.??.????"),{2,1}},
{string("#.?#?#?..?.###?#??"),{1,2,2,1,5,1}},
{string("?????.#.??#"),{4,1,1}},
{string("?.?.?????????????#?"),{1,9,1}},
{string("???..###?.?"),{2,3}},
{string("???#???#.####????"),{3,1,6}},
{string("?#???#??????##?..?"),{1,7,3}},
{string("????#.????#??.??.??"),{4,1,3,1,1}},
{string("???#???????"),{2,2}},
{string("#.??.???#??#???#?"),{1,1,4,2,3}},
{string("#???#.???????##???"),{1,1,2,1,5}},
{string(".????#?????#?????"),{1,4,5}},
{string("??#..#??#?"),{1,1,1}},
{string("..?#?????."),{3,1}},
{string("??.???##??"),{1,2,3}},
{string("????.?????"),{1,1,1}},
{string("?##???.#?#???.#.#?"),{2,1,1,3,1,1}},
{string("??.#?????##?#..??.??"),{1,2,1,5,2,1}},
{string(".??????#??#????#.?"),{1,4,1,4}},
{string("??#?#?#?##????.??"),{1,10,1,1}},
{string(".????????#"),{2,1,1}},
{string("??#???.????.##??"),{3,1,2,4}},
{string("???.##?.???.???#?.??"),{2,2,2,1,2,2}},
{string("?##?????#?????#??"),{2,4,1,4}},
{string("??.?#??#???????.??"),{2,2,1}},
{string("#??#??????.????#?"),{1,7,3}},
{string("?.#???#.#?"),{1,5,1}},
{string(".?#?????#??.?"),{4,3,1}},
{string(".##??.?????.??"),{4,1,2,1}},
{string("???#??#?.??"),{1,3,2}},
{string("?##???#????."),{2,1,1,2}},
{string("????.###??"),{2,3}},
{string("#.??#??????????????"),{1,5,6,1,1}},
{string("????#????#?.#"),{2,7,1}},
{string("????.??#.?"),{3,1}},
{string("??????..?##.??????"),{2,1,3,1,1,1}},
{string("?#??.?##?#???"),{1,1,7}},
{string("#?.??.#..???"),{2,1,1,1}},
{string("??????#??.??#??#"),{1,2,3,1}},
{string("??##??##??#?.."),{1,2,3,3}},
{string("???????????"),{1,6,1}},
{string("??????.##???#???"),{2,8}},
{string("#????????#??"),{1,1,1,2}},
{string("???????.???"),{2,2,1}},
{string("?.????..??.?.??"),{1,3,2,1}},
{string("#??.#?#????"),{1,3,1}},
{string("???###.?..#???.#??."),{6,1,1,1,3}},
{string(".#??????#?#?????"),{2,2,3,4}},
{string("?????..#.#?"),{3,1,1}},
{string(".?????#.???#??"),{6,3}},
{string(".#??##.???#?#?#????"),{1,2,1,6,1}},
{string(".??#????#?#.?????.?"),{9,1,1,1}},
{string("?????????#??."),{3,3}},
{string("?#..?#???#?"),{2,1,3}},
{string(".#.??#?###.???"),{1,6,2}},
{string("?.??.?#?.?"),{1,2,3}},
{string("??#.????????.???#?"),{1,1,1,2,4}},
{string("???????#??#?#??.?"),{2,1,4,1,1}},
{string("?????#???..#??"),{1,2,1,2}},
{string(".???#?#????????"),{3,1,2,4}},
{string("???##??.??#?."),{5,3}},
{string("?#.??#??.?"),{2,3,1}},
{string(".#.?#?#????.???????"),{1,6,1,3,1,1}},
{string("?????#???????##??#"),{1,3,7,1}},
{string(".???????#??.?"),{1,2,2,1}},
{string("?#??####???"),{8,1}},
{string("??????.??##???##?#??"),{2,1,5,4}},
{string("?.???????..??.?##???"),{1,4,1,1,6}},
{string("??#?#???????????..#?"),{3,5,1,1,2,1}},
{string("??#???#.???.??"),{2,1,1,2}},
{string("?##?##.?????##??#"),{2,2,7,1}},
{string("????.???#?#?.?#?"),{1,2,2,4,2}},
{string("?#.?#?.?#?"),{2,1,3}},
{string("???????#?#???"),{1,8,1}},
{string("??????#??#??."),{4,3,1,1}},
{string("???#??##?#??.?.???#?"),{2,5,2,1,1,1}},
{string(".??#??.??###??.??"),{3,6}},
{string("?????#.?#???"),{3,1,3}},
{string("???.??.??#????"),{1,1,3,1}},
{string(".?.?.###???#?????#"),{1,1,7,1,2}},
{string(".?##?.??.#??###.?."),{4,2,6,1}},
{string("##.??#???#####?#???"),{2,3,10}},
{string("???????????"),{1,1,3}},
{string("?.???##???..?."),{1,5,1,1}},
{string("??#?#?#?#?#???#"),{10,2}},
{string("???#?#??#?##??#????"),{16,1}},
{string(".?..?.??.?#??.#"),{1,1,2,4,1}},
{string("?#.?#????#.??#?"),{1,1,2,1,3}},
{string("?.#???#???#?#???"),{6,4}},
{string("?..???.#?#??.??.?.?"),{1,2,5,1,1}},
{string("?#.????##??###????"),{2,5,7}},
{string(".##????###??#..#????"),{10,1,3}},
{string("?#??.???.?#"),{4,2,1}},
{string("????##?????.??#?.?.?"),{1,7,3,1}},
{string("?##??.???#????????#?"),{2,1,3,8}},
{string("????#??..???.?????."),{2,3,1,3}},
{string("?#.#???#???.??.????"),{2,2,1,1,2,1}},
{string("...?????.??"),{1,2,1}},
};

TEST(TestCaseName, doPuzzle) {
	ASSERT_EQ(7705, doTheThing(puzzleInput));
}