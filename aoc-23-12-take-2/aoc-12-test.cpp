#include <gtest/gtest.h>

#include <pex.h>

using namespace pex;
using namespace std;

using Groups = std::vector<int64_t>;

int64_t minLength(
	Groups::const_iterator brokensBegin,
	Groups::const_iterator brokensEnd) {

	return reduce(brokensBegin, brokensEnd) + distance(brokensBegin, brokensEnd) - 1;
}

bool patternMatch(const string_view& pattern, const string_view& b) {
	// as long as b matches front of pattern we're fine
	if (ssize(b) > ssize(pattern)) {
		return false;
	}
	for (int64_t i = 0; i < ssize(b); i++) {
		if (pattern[i] != '?' && pattern[i] != b[i]) {
			return false;
		}
	}
	return true;
}

std::string buildPossible(int64_t front, int64_t mid, int64_t back) {
	std::string result;
	for (int64_t i = 0; i < front; i++) {
		result.push_back('.');
	}
	for (int64_t i = 0; i < mid; i++) {
		result.push_back('#');
	}
	for (int64_t i = 0; i < back; i++) {
		result.push_back('.');
	}
	return result;
}

int64_t _findArrangements(
		const std::string& pattern, 
		Groups::const_iterator brokensBegin, 
		Groups::const_iterator brokensEnd) {

	int64_t count = 0;
	cauto cellCount = std::ssize(pattern);
	cauto _minLength = minLength(brokensBegin, brokensEnd);
	if (brokensBegin+1 == brokensEnd) {
		int64_t possibles = cellCount - _minLength + 1;  // 'frex, group of 2, 5 spaces, 3 possibilities"
		for (int64_t i = 0; i < possibles; i++) {
			cauto possibleMatch = buildPossible(i, *brokensBegin, cellCount - i - *brokensBegin);
			if (patternMatch(pattern, possibleMatch)) {
				++count;
			}
		}
	}
	else if (_minLength > cellCount) {
		count = 0;
	}
	else {
		// a wide variety of options. place the first broken, then repeat with 
		// one less broken
		
		// the space available for the first string of broken devices is the total space available
		// minus the minimum space needed for all the devices 
		int64_t wiggleRoom = cellCount - minLength(brokensBegin, brokensEnd);
		for (int startingGap = 0; startingGap <= wiggleRoom; startingGap++) {
			cauto possibleMatch = buildPossible(startingGap, *brokensBegin, 1);
			if (patternMatch(pattern, possibleMatch)) {
				cauto subPattern = pattern.substr(*brokensBegin + startingGap + 1);  // use view here to avoid temp copy
				int64_t subArrangements = _findArrangements(subPattern, brokensBegin + 1, brokensEnd);
				std::cout << possibleMatch << " + " << subPattern << " : " << subArrangements << std::endl;
				count += subArrangements;
			}
		}
	}
	return count;
}

int64_t _findArrangementsDP(
	const std::string_view pattern,
	const Groups& groups) {

	auto dpGrid = createGrid<int64_t>(pattern.size()+1, groups.size()+1, 0);
	// there's always 1 way to fit the pattern when you have 0 groups
	dpGrid[0] = std::vector<int64_t>(pattern.size() + 1, 1);

	// begin with last group at end of pattern
	for (int64_t groupSlice = 1; groupSlice <= std::ssize(groups); ++groupSlice) {
		cauto _minLength = minLength(groups.end() - groupSlice, groups.end());
		for (int64_t patternSlice = _minLength; patternSlice <= std::ssize(pattern); ++patternSlice) {
			int64_t count = 0;
			cauto groupSize = groups[groups.size() - groupSlice];
			cauto wiggleRoom = patternSlice - _minLength + 1;
			for (int64_t i = 0; i < wiggleRoom; i++) {
				cauto remaining = patternSlice - i - groupSize; // includes the unusable space after the last thingy
				cauto possibleMatch = buildPossible(i, groupSize, groupSlice == 1 ? remaining : 1 );
				if (patternMatch(pattern.substr(std::ssize(pattern) - patternSlice), possibleMatch)) {
					cauto usableRemainingSpace = remaining - 1;
					count += usableRemainingSpace >= 0 ? dpGrid[groupSlice - 1][usableRemainingSpace] : 1;
				}
			}
			dpGrid[groupSlice][patternSlice] = count;
		}
	}
	printGrid(std::cout, dpGrid, ",") << std::endl;
	return dpGrid[std::ssize(groups)][std::ssize(pattern)];
}

int64_t findArrangements(
	const std::string& pattern,
	const Groups& groups) {
	return _findArrangementsDP(pattern, groups);
	//return _findArrangements(pattern, groups.begin(), groups.end());
}

int64_t findArrangements2(
	const std::string& pattern,
	const Groups& groups) {
	
	const std::string newPattern = pattern + '?' + pattern + '?' + pattern + '?' + pattern + '?' + pattern;
	Groups newGroups;
	for (int i = 0; i < 5; i++) {
		newGroups = pConcatenate(newGroups, groups);
	}
	return findArrangements(newPattern, newGroups);

}



int64_t doTheThing(const vector<pair<string, vector<int64_t>>>& input ) {
	// want a more ergonomic that:
	cauto result = transform_reduce(input.begin(), input.end(), 0ll, std::plus{}, [](cauto& element) {
		return findArrangements(element.first, element.second);
		});
	return result;
}

int64_t doTheThing2(const vector<pair<string, vector<int64_t>>>& input) {
	// want a more ergonomic that:
	cauto result = transform_reduce(input.begin(), input.end(), 0ll, std::plus{}, [](cauto& element) {
		return findArrangements2(element.first, element.second);
		});
	return result;
}

TEST(Aoc12_2_Tests, TestTest) {
    ASSERT_EQ(0,0);
}

TEST(Aoc12_2_Tests, patternless_test) {
	vector<int64_t> brokens = { 2,1 };
	ASSERT_EQ(10, _findArrangements("???????", brokens.begin(), brokens.end()));
}

TEST(Aoc12_2_Tests, puzzleSample) {
	ASSERT_EQ(6, findArrangements("??.???.?.?.??.???.", { 2, 2, 1, 1, 2, 1 }));
}
TEST(Aoc12_2_Tests, part1Samples) {
	ASSERT_EQ(1, findArrangements("???.###", { 1,1,3 }));
	ASSERT_EQ(findArrangements(".??..??...?##.", { 1,1,3 }), 4);
	ASSERT_EQ(findArrangements("?#?#?#?#?#?#?#?", { 1,3,1,6 }), 1);
	ASSERT_EQ(findArrangements("????.#...#...", { 4,1,1 }), 1);
	ASSERT_EQ(findArrangements("????.######..#####.", { 1,6,5 }), 4);
	ASSERT_EQ(findArrangements("?###????????", { 3,2,1 }), 10);
}

TEST(Aoc12_2_Tests, part2Samples) {
	ASSERT_EQ(1, findArrangements2("???.###", { 1,1,3 }));
	ASSERT_EQ(16384, findArrangements2(".??..??...?##.", { 1,1,3 }));
	ASSERT_EQ(1, findArrangements2("?#?#?#?#?#?#?#?", { 1,3,1,6 }));
	ASSERT_EQ(16, findArrangements2("????.#...#...", { 4,1,1 }));
	ASSERT_EQ(2500, findArrangements2("????.######..#####.", { 1,6,5 }));
	ASSERT_EQ(506250, findArrangements2("?###????????", { 3,2,1 }));
}


const vector<pair<string, vector<int64_t>>> puzzleInput = {
{string("?#.???#???????##?.?"),{2,1,7,3,1}},
{string("?.##?###?#?##?"),{1,6,1,2}},
{string("??.???.?.?.??.???."),{2,2,1,1,2,1}},
{string("?????#???#??#??..?#?"),{15,2}},
{string("#?????????#.?#"),{1,2,5,1}},
{string("??..?.???#"),{1,4}},
{string("?##???.????"),{3,2,2}},
{string("..??.????????.??"),{1,3}},
{string(".?????????.#??"),{1,6,2}},
{string("?#?#??????##??#..#"),{1,2,7,1}},
{string("??.?????###??"),{3,4}},
{string(".???????#.?"),{4,3,1}},
{string("??????#.?#????"),{2,2,4}},
{string("???.???#?..?????."),{2,1,1,5}},
{string("???#???#???#?#?????."),{2,9,2}},
{string("????.#.?????#?#"),{1,6}},
{string("???????.#??"),{1,1,2}},
{string("#????#??.???."),{2,1,1,1}},
{string("??#?????.????"),{2,1,1,1}},
{string(".#?.?.#????#?.#"),{1,1,4,1}},
{string("##?????##???"),{3,3,2}},
{string("??.?????#?"),{1,1,3}},
{string("??????.??????##.??#?"),{2,2,1,6,3}},
{string("?#???.?#??"),{1,1,4}},
{string("#?#???.????"),{4,1,2}},
{string(".#.?.??#??"),{1,1,3}},
{string(".?#???#??#??#?#?."),{1,10}},
{string("?##...?##???.?"),{2,5}},
{string(".#??????????????"),{8,1,1}},
{string("???...???#"),{1,1,1}},
{string("??#???.?????????#??"),{3,4,4}},
{string("????.?.???.#.??"),{1,1,3,1,1}},
{string("?#??.?#???"),{2,1,3}},
{string("?????##????#????"),{11,1}},
{string("??????.????"),{4,1}},
{string("?????#?..?#?.??"),{2,2,3,1}},
{string("??????.#..?#????#"),{2,1,4,1}},
{string("??.???#..#?"),{1,2,2}},
{string("#?#??.#????#?"),{1,1,1,2}},
{string("?.#?..?#??"),{2,4}},
{string("?.?????##??.#?????##"),{8,8}},
{string("???.???.??."),{1,2}},
{string("??#??????#"),{7,1}},
{string("????#?####?#?#"),{9,1,1}},
{string("???#??#.????."),{1,4,2}},
{string("??#?#?????.##??.?.??"),{5,1,1,4,1,1}},
{string(".#??.??????#?????#?"),{1,1,5,3}},
{string("???#???.????#???."),{4,1,4}},
{string(".?.??#??????#??."),{3,5}},
{string("???????..??"),{1,2,2}},
{string("????#.????????"),{2,2}},
{string("?.????????##??"),{3,2}},
{string("?.?.????????#??????#"),{1,2,4,4,1}},
{string("???#??.????.???#???"),{4,1,1,3}},
{string("????????????.."),{5,1}},
{string("??.#??????##"),{1,1,1,2}},
{string("..?.?#?????.?.."),{3,1}},
{string("??#??.?#??.??#?????"),{4,3,3,2}},
{string("???#?#???##????##??"),{5,7,2,1}},
{string(".????#?????#.."),{5,2}},
{string("..?#..##???.?"),{2,3}},
{string("???????.?.?"),{4,1}},
{string("#????????#?????."),{1,3,1,6}},
{string("?#?#??.??.?#????."),{1,3,1,6}},
{string("?#???.??#??."),{4,3}},
{string("?#.#.????#?#?????#?"),{2,1,8,4}},
{string("??.#???????.?"),{2,2,1}},
{string("..???????.?"),{2,3}},
{string("?#.??????????"),{1,7}},
{string("?.??#??#????????????"),{1,7,3,1,1}},
{string("???????.#?????"),{3,3,5}},
{string("?..????.???#."),{1,1,2,1}},
{string("?.?????.?#.??..?"),{3,1}},
{string(".#?..?##????"),{1,4}},
{string("?????...???????"),{3,2}},
{string("???.?.??????"),{2,1,1,3}},
{string("#???#.#?#???"),{5,5}},
{string("????#???.???"),{5,1,2}},
{string("????#????#?.??##?#?"),{1,4,2,4,2}},
{string("??#???????????."),{2,1,1,1}},
{string("#?.##??###????.?????"),{1,7,2,1,1,1}},
{string("?#??##??.?#?#?##??"),{5,7}},
{string("?#???.?#??"),{4,1}},
{string("..??.??#???."),{1,4,1}},
{string("??.????.??"),{1,2,2}},
{string("???.??.??#????"),{1,1,5}},
{string("?..??#?##???#???#"),{1,6,5}},
{string("???#?????????#??"),{4,1,5}},
{string("?#???#?#??.?"),{1,1,1,1}},
{string("???.???.#?.???."),{1,3,2,2}},
{string("????###?..??.?#???."),{7,1,4}},
{string(".??#?.?????"),{4,1,3}},
{string(".#.???????"),{1,3}},
{string("#????##???.?"),{1,5}},
{string("??.???#?????#????"),{2,3,5}},
{string("??#?##?????#"),{7,2}},
{string("???#????#.."),{4,2}},
{string(".????.????#?#????"),{3,1,3,5}},
{string("??.????.???.??#??#??"),{2,1,2,6}},
{string("?????#??#?#?????"),{1,5,3,1}},
{string("??????.#??"),{3,2}},
{string("??#????.?#?."),{4,3}},
{string("???#???????????#?#."),{2,1,3,1,1,3}},
{string("???#.?###???##??#"),{1,1,12}},
{string("?#????#?##.???.?.?#?"),{1,6,2,2}},
{string(".?#??.?#???#???????."),{4,7,1}},
{string("?###???#????##??.?"),{5,2,2,1}},
{string("??#?#????#?#?..??"),{1,1,4,4,1}},
{string("???.#?.??????"),{2,2}},
{string("??#???#???????"),{7,1,3}},
{string("?.?##????#?."),{3,4}},
{string("??.??#???????."),{1,1,4}},
{string("?.?#???????...?????"),{7,2}},
{string("????.???#??.?."),{1,4}},
{string(".#?.?#?#???????"),{1,6}},
{string(".?????###??????????."),{8,3}},
{string("#?.#?#??#??????"),{2,3,2,4}},
{string("#?#?#????.???????"),{6,7}},
{string("??.?#??.#?#?"),{1,2,1,4}},
{string("??.?#???##?###?#"),{1,2,6,1}},
{string("?.??...???"),{2,2}},
{string("#??##?#??.?#???"),{1,3,1,1,2}},
{string("????##?????.??.?.."),{4,1}},
{string(".?###????..?.?#"),{8,2}},
{string(".????#??.#.#??"),{5,1,3}},
{string("??#??.????##..?"),{4,6}},
{string("?#?..???#?????????.?"),{2,1,4,5}},
{string("..??..??#.??"),{1,2}},
{string("?.#?.?.???#?##??????"),{1,2,1,1,5,1}},
{string("??.?##.?..????"),{1,2,1,2}},
{string("??.??????#?.???"),{1,1,4,2}},
{string("???#...??#?#.#"),{1,5,1}},
{string("????.???##?#?.#"),{1,8,1}},
{string(".???#?????.?"),{3,1}},
{string(".##???#.?#??#??."),{3,1,2,3}},
{string("??#??????#???.?"),{2,1,1,3,1}},
{string("???#?.???#???#???"),{2,3,2,2}},
{string("???????#????????????"),{2,2,10,1}},
{string(".???#??.?#??#?#."),{1,1,1,6}},
{string("????##??#?.."),{6,2}},
{string("????###?##?#??"),{4,4,1}},
{string("???#????#????"),{3,7}},
{string("?.?###?.#???#???"),{3,1,3,1}},
{string(".#?.??#?.??#???"),{1,1,2,2,2}},
{string("????#??##?."),{1,5}},
{string("???????#?##.?.#.?"),{2,6,1,1}},
{string("?#?..???.?#?..???"),{2,1,1,3,1}},
{string("??#???#.??.#?#???#"),{1,1,2,2,4,1}},
{string(".#.?#.?#???#?."),{1,1,1,3}},
{string("??.##??.??#.?.?"),{1,4,3,1}},
{string(".?#??.????#"),{4,1}},
{string("???##?#????##?"),{2,10}},
{string("??#???????#?"),{3,1,2}},
{string("##.??#?#??##?"),{2,9}},
{string("?#?#?#?????.???.?.?"),{10,1}},
{string("?..#????#????#?."),{1,1,1,6}},
{string("...?????#???????#"),{9,1,2}},
{string(".???.???.??"),{3,1,1}},
{string("??#.?.????#?#??#???"),{1,1,1,10}},
{string("??.??.#??#?#?.??#??."),{2,7,2}},
{string("??##?#?..??.???"),{7,1,1,1}},
{string("?#????.#.???#.?#.#"),{5,1,4,2,1}},
{string(".?####??#.????"),{8,1,1}},
{string("????..#???????"),{1,1,1,4}},
{string("?.#???#..?????"),{3,1,1,1}},
{string("???##?#??.#?"),{1,2,3,1}},
{string("?????.#???#?.???."),{1,6,3}},
{string(".?.???????."),{1,2}},
{string("#?.?????##?"),{2,6}},
{string("?##????????"),{2,2,1}},
{string("?#.##??##?#"),{2,2,4}},
{string("??#?.#?.#?.?#??#.?#"),{1,1,1,1,5,2}},
{string("????#???????#?.?#.."),{9,2,1}},
{string("?????#.??####?"),{1,2,7}},
{string("#???#??????"),{6,1}},
{string("???#?.????#"),{2,2,1}},
{string(".#.#.#??#??"),{1,1,6}},
{string("?#??##?#????.?..????"),{8,1,2,1}},
{string("?##????????????"),{4,5}},
{string("??#??.#?????##."),{3,1,3}},
{string("???.?#?????????#??.."),{1,1,12}},
{string("??????#?????.?#"),{1,7,1,1}},
{string("??.#????????"),{3,1}},
{string("??.?#?#?.???#???"),{1,3,6}},
{string("?#??#???.??.??#"),{1,1,1,1,1}},
{string("#???#????????.???."),{1,1,3,5,1,1}},
{string("#??..?.#????#?"),{1,1,1,4}},
{string("?????.????"),{3,1}},
{string("??????###?.?"),{1,7,1}},
{string(".#..?##??#??.????"),{1,6,2}},
{string("?##???#?.##"),{6,2}},
{string("?##.??.??#?.???#???"),{3,2,1,1,1,1}},
{string("???##.?#????#???"),{5,1,1,3}},
{string("#.??#??.?#????.???#?"),{1,3,1,6,1,1}},
{string("??#???#.??#.#???"),{7,1,1,1,1}},
{string("#??#?????.?.?"),{7,1,1}},
{string(".?????.?#????..#?#?"),{4,5,3}},
{string("?.?.#??#??.?????"),{4,1}},
{string("#.??#?##?...#."),{1,5,1}},
{string(".??..?.##???"),{1,1,4}},
{string("???#????????#??.?"),{3,8}},
{string("???????##??????"),{2,1,4,1}},
{string("???????.??."),{2,2,1}},
{string("?#.#??##???.????"),{1,1,3,1,1}},
{string("?.?????????."),{1,1,3}},
{string(".???#??#??.#?####?#"),{6,8}},
{string("?.?#??#??.??"),{1,1,2,1}},
{string(".??.???#???????"),{1,6,1}},
{string("??#..#???.??"),{1,1,1,1}},
{string("?...#????.#?"),{1,1}},
{string("??.??.???."),{1,1,1}},
{string("??#?##????.#?.??"),{10,2,1}},
{string("????????.?#????#????"),{2,3,4,2,2}},
{string("???????#?#????.##.?"),{2,8,2}},
{string("??#?????.?."),{4,1}},
{string("??#???.?.??#??????"),{1,1,2,1,5,2}},
{string(".??.????#?#?#??"),{1,1,3,2}},
{string("#???.??.#??##?????.?"),{1,1,1,1,5,1}},
{string("##??#?????#??????#??"),{5,12}},
{string(".?#????..??#?#????."),{5,7}},
{string("????#.?????.?.?#?"),{4,1,3}},
{string(".#..?#?????.?#"),{1,5,2}},
{string("??????.?????#"),{3,1,1}},
{string("?#?????.???"),{1,3,1}},
{string("#.??##???##?.???##?"),{1,10,2,2}},
{string("??#???..#?#?"),{4,1,1,2}},
{string(".?.#?.?.???."),{1,1,1,1}},
{string(".#?.#.#??.??????"),{1,1,2,1,2}},
{string("?#??.?#????#."),{2,6}},
{string("??????##??."),{1,2,1}},
{string("???????.??.????.??"),{1,1,1,2,4,1}},
{string("?#??????#??###.#.??"),{3,10,1,1}},
{string("..???#?????#?#?#?"),{3,7}},
{string("?..#????????."),{1,1,4}},
{string("?#??#?#.??"),{1,4,1}},
{string("???##??##?.?"),{2,2,3,1}},
{string("#??#####???#.???"),{8,2,1}},
{string("??#?.????.?"),{3,1}},
{string("...????#??"),{1,4}},
{string(".?#?????###?##.?"),{3,4,2}},
{string("????#.????##???"),{1,4}},
{string("?##??????.##"),{2,1,2}},
{string(".?..?#.????#?????"),{1,1,8}},
{string(".#?#?.?.???..?"),{4,3}},
{string("??#??????#?#."),{1,1,5}},
{string("#?????#?###????#???"),{1,9,1,2,1}},
{string("???????###??.??.?"),{1,1,8,1,1}},
{string(".??.???#?#.#??.?#.#"),{1,6,1,1,1,1}},
{string("???#????????."),{5,4}},
{string(".?##??????????"),{7,4}},
{string("?????.??.?#??"),{5,1,2,1}},
{string("#.????????##"),{1,1,3,3}},
{string("???#????.????##.??"),{7,5}},
{string(".#?.??#??##???"),{2,7}},
{string("#?..??#?#..???#"),{2,4,1,1}},
{string("??#..??#??#????#????"),{1,1,1,4,4}},
{string("??????????????."),{2,1,1,4,1}},
{string("#??#???.?#."),{4,2,2}},
{string("#.??#???#??.?#??.??"),{1,8,1,1}},
{string("??.???#?????#??????"),{1,2,3,3,5}},
{string("????.#..???#??#?#?"),{1,1,1,7}},
{string(".#?????.???????.#"),{3,1,2,2,1}},
{string("???##??.?#??.??"),{5,2,1,1}},
{string("????.?##????#"),{2,2,3}},
{string("??????#.?#??"),{1,2,2,1}},
{string("##?.#.#??????#??"),{3,1,1,7}},
{string("?????.?????#????????"),{6,1}},
{string(".?.???##????."),{4,2}},
{string("????#????#??????"),{1,6,1,2}},
{string("??#?##??????##?#???"),{1,7,7}},
{string("?..???#.??.?"),{2,1,1}},
{string("#?????#.??.?#.????"),{1,5,1,2,1}},
{string("???##?#??..??.?#??"),{3,3,2,2}},
{string("?#??.??#?.?"),{2,4}},
{string("?????????#??#??????"),{1,1,7,2}},
{string("???#????#???#?#?."),{1,7,6}},
{string("?????#?..??#????#???"),{4,4,5}},
{string("#?#????????????"),{3,4,1,1,1}},
{string("???#????#.#.????"),{1,3,1,1,2}},
{string("??.??#???#.??"),{2,3,1,1}},
{string("?????.??##???.??.??"),{1,7,2}},
{string(".??#???????##???"),{1,10}},
{string("?###????#????#??#"),{4,1,3,4}},
{string(".?????.?.??."),{3,2}},
{string("?.?.?#??.??"),{1,2}},
{string("#?????#???#?"),{7,2}},
{string("??#??????.?#???#?#??"),{5,8}},
{string("????#??.????#.???#?"),{1,4,3,1,1,2}},
{string("???#??.????"),{4,1}},
{string("?#?????#?#."),{3,3}},
{string("#.?????#?.????#?#"),{1,6,4,1}},
{string("??#??..#????."),{2,1,2,2}},
{string("#?????#??#.???????"),{2,3,1,3,1}},
{string("?????###?#?.??#??"),{7,1}},
{string("###???????.??"),{4,2,2}},
{string("??#..??###"),{3,5}},
{string("?.##.#??????"),{1,2,1,3}},
{string("??#?#?.#?.#????"),{1,4,1,3,1}},
{string(".??????????"),{1,2}},
{string(".????.#??#???##?#"),{1,1,1,2,5}},
{string("?????##?????????."),{4,5}},
{string("???..???#?.#.?#?#??"),{5,1,5}},
{string("???.???????##???.??"),{1,1,2,1,5,2}},
{string("??.????#??##??????"),{1,9,2,1}},
{string("#?#???#?###???#??##."),{1,10,5}},
{string("????##????##?..?#"),{2,4,2,1}},
{string("##??..?#???????.?"),{3,5,1,1}},
{string("??##.?#????#??#.?#"),{4,10,1}},
{string("?????????????"),{1,1,1,1}},
{string("?.????#.?.#?.?"),{1,5,2}},
{string(".?.#??.#...##???.??"),{1,3,1,2,2,1}},
{string("??##.??..?#?#"),{2,2,3}},
{string(".?.#????#??#?"),{2,6}},
{string(".???????#??#.???.?"),{1,7,1,1}},
{string("??.????????"),{1,3}},
{string("??.??#?.?????##??.??"),{1,3,6}},
{string("????.?????#?##??.?"),{3,11,1}},
{string("???..????#.##?"),{1,2,1,3}},
{string(".??#???.???."),{3,1,1}},
{string("??.???..?##???.."),{2,2,4}},
{string("???.#??##????????"),{1,1,4,1,1}},
{string(".?..??????"),{1,1,3}},
{string("??#???..????"),{5,2,1}},
{string("?????##??#??????#?"),{1,9,1,1}},
{string("??.?????.??????#"),{1,5,1,1,1}},
{string("??????#???."),{1,1,5}},
{string(".?????###..?.#?."),{1,1,4,1,1}},
{string("????#?#.???##?"),{1,3,1,5}},
{string("?.?..????###??.."),{1,5}},
{string("???.#????."),{3,1}},
{string(".#?#?.#?#?.???#"),{1,2,3,4}},
{string("????#??#??#?#????"),{2,7,2}},
{string(".?.???#?#??##???#"),{1,13}},
{string("#??#???#..?#??#?????"),{1,6,5,4}},
{string("#???????#??"),{4,5}},
{string(".??#??????.??#"),{2,1,1,3}},
{string("??#????.?.#"),{2,1,1}},
{string(".#??##?#.#?..???#"),{7,1,3}},
{string("..?#??????##??.?"),{3,1,4}},
{string("#??#??#??.?#."),{1,5,1,1}},
{string(".???#????.#?#?"),{6,4}},
{string(".??#???#?.???????"),{3,1,2,3}},
{string("????????.#?#.#"),{1,3,3,1}},
{string("??.?#????#??????????"),{1,11,1,1}},
{string("..??#?.???#?.?.?."),{3,1,1,1}},
{string("?#?????##??##.#"),{2,8,1}},
{string("????#???#???????"),{2,1,6,1}},
{string("#???.?##???#?##"),{1,1,4,2,2}},
{string("?????#??##?#??#"),{11,1}},
{string("?.?#.#????#?#?#?#?"),{1,1,3,2,5}},
{string("##???.????.????"),{3,1,1,2}},
{string("???..##?.??..#?"),{2,3,1}},
{string("???#??#?.??.?????"),{6,1}},
{string("?.?#??.????#??#?#??"),{2,7}},
{string(".?#????.??#??#???#?"),{6,2,2,1}},
{string("???.?#???.?"),{1,4,1}},
{string("?##.????####?"),{2,6}},
{string("###??????#?#?"),{5,3}},
{string("?.#??#.?..##??????"),{4,6,1}},
{string("?.#.#.???#?##???????"),{1,1,1,10,1}},
{string("??.?#?????#"),{3,2,1}},
{string("??#????#?#??"),{2,3,1,1}},
{string("?#?.??#.???"),{1,3,1}},
{string("????.?#???#?#?????"),{2,1,2,3,1,3}},
{string("????#?.??#????.#?"),{1,1,5,1}},
{string("????????#??#??#?#?"),{1,1,1,1,5,2}},
{string("???.??????#?"),{1,2,4}},
{string("????.??#???#"),{1,5}},
{string("?????????#??????????"),{2,10,2,1}},
{string("??????#??.."),{2,3}},
{string("?????#.?#??#??"),{3,1,5,1}},
{string("?????#??#?..??"),{3,4,1}},
{string("??#???#???#???.?.?#?"),{3,10,1,1}},
{string("#?##??????#???????."),{7,1,3}},
{string("??#??????.?##??##???"),{7,7}},
{string("??????##?#??????"),{1,8,1}},
{string(".????#??#???????."),{7,3}},
{string("?#?###???..."),{5,1}},
{string(".?#??????.?????"),{1,2}},
{string("?.?#?????#.???#??"),{1,5,1,3,1}},
{string("????#?????#??#??."),{5,2,2,1,1}},
{string(".?.?#?#???#??."),{1,5,1}},
{string("???.????#??##??"),{1,8}},
{string("#???.????#????????"),{2,8}},
{string("??.##?#?#??"),{1,6,1}},
{string("?????????#..?#?#?..#"),{9,4,1}},
{string("??????..?.???#.#??"),{2,4,1}},
{string("?.#.?#????."),{1,1,2}},
{string("?##???#?????##?.???#"),{3,5,4,1,1}},
{string("#??#?#.?????#??#?##?"),{1,1,1,1,7}},
{string(".?.????#???#???????"),{1,1,1,2,6,1}},
{string("??????????###??"),{2,7}},
{string("#??????#?###??????"),{1,10,2,1}},
{string("#??.?.??#?#?"),{2,1,5}},
{string(".#..?????#?.??"),{1,1,4,2}},
{string("#?...#?.#???#?"),{2,1,1,3}},
{string("###?#??##???????#??"),{14,1}},
{string("??#?.?#????#??#?????"),{2,11,1}},
{string("???...??.#?#?."),{2,1,4}},
{string("#??.#??#????#??"),{1,4,6}},
{string("???.#.??#?#???.?##."),{1,1,1,6,3}},
{string("???????..?????#???"),{1,1,1,1,6,2}},
{string("???##????.????#..?."),{5,2}},
{string(".???#?.?????#."),{4,2,1}},
{string(".??????????#.#?"),{1,1,5,1}},
{string("????.?.??#?##????"),{2,6}},
{string("#?.?#?.????#.?????#"),{1,2,1,1,1,4}},
{string("?#.?#??????#?"),{1,9}},
{string("??#?#???#?#?????.?#?"),{7,1,1,1,1}},
{string("...?##?#.????."),{4,1}},
{string("?????????.#?"),{3,2}},
{string("?.#?#?????#??"),{5,1,1}},
{string("?###.???#?."),{3,2}},
{string("?.???#.????#??"),{2,6}},
{string("???.??..???#??."),{1,2,5}},
{string("?#..?#?????##???."),{2,9,1}},
{string("#?.??###?#?#??.????."),{2,8,1,2}},
{string("???#?.????.???????"),{4,4,6}},
{string("???#?????#?#?.#"),{2,1,5,1}},
{string(".?????#???#???"),{1,2,4}},
{string("???##???????"),{6,2}},
{string("???????#.????#???"),{6,1,2}},
{string("????????#???.?#??##"),{1,1,1,1,1,6}},
{string("?#?.?#??#?"),{2,2,2}},
{string("#..?.?#.???????#????"),{1,1,1,1,1,5}},
{string("???.?.????"),{2,1}},
{string("#???..???#??.??#.??"),{1,1,2,3,1,1}},
{string("???#..##?#???#?"),{3,4,1}},
{string("??.#?????????????"),{7,3,1}},
{string("?..?.??????"),{1,1}},
{string("?#????..#.#?????"),{2,1,1,1,2}},
{string(".?.????????????"),{1,1,1,4,1}},
{string("?.????????#?"),{2,3}},
{string("#?????#..???#?"),{1,3,1,1}},
{string("???.?????##."),{3,2}},
{string("?.??????#??.???#???"),{4,1}},
{string(".?????#??#???#?#?."),{8,4}},
{string("???..?##??.#"),{1,1,3,1}},
{string("???.??#??#?##"),{1,7}},
{string("????.#??#????."),{1,5}},
{string("#?..????.#??.??"),{2,3,3}},
{string("???????##?????????#"),{3,1,9,2}},
{string("#??##?#??#.?#?"),{2,2,4,2}},
{string("?.?#?#?????."),{1,1,3,1}},
{string("?#???#???????"),{6,2,1}},
{string("?????..?.#?."),{1,1,1,2}},
{string("?????.?#??#??."),{1,5}},
{string("??#??#.#??"),{2,1,1}},
{string("..?..#.#??##?#..#?"),{1,1,7,2}},
{string("??????##?#?.??#???"),{1,1,2,1,5}},
{string("?#??#?#??.??.???"),{2,2,2,1,1}},
{string("??...??#?#?#????."),{1,8}},
{string("???#???#?#"),{1,2,4}},
{string("?#??..??.?#.?"),{2,2}},
{string("#??#??#???"),{1,6}},
{string("?????...???##??????"),{1,2,5,2}},
{string("?#..#?????#???#..?"),{1,11}},
{string("??????.????.##"),{2,1,2,2}},
{string("??#????#??##??????."),{1,9,1,2}},
{string("#??###???..????"),{6,1,2}},
{string("????????????#??.????"),{9,2,1,1}},
{string("??#????????"),{4,1,1}},
{string("?#????#.??#?????"),{4,1,1,1,2}},
{string("?#..?#?????????#??"),{2,3,1,1,1,2}},
{string(".???????#??.?"),{2,6,1}},
{string("???#?????#?????#??#?"),{1,8,1,4}},
{string("?#?.???.???"),{1,3,1}},
{string(".??????...??.??#?.??"),{5,1}},
{string("??.?#????#???##???.?"),{2,1,11}},
{string("???#?.???#.#.?"),{4,4,1}},
{string("#?###?????#.????"),{1,4,1,1,1}},
{string(".???.?????.????"),{1,1,2,1,1}},
{string("???#??#????.???"),{4,3,1}},
{string("????.?????#??"),{1,1,5}},
{string("??##??.?..??????"),{1,3,1,1,1}},
{string("????????..#?."),{7,2}},
{string(".????##??..?"),{1,3,1,1}},
{string(".##?#??.#?#?#???"),{5,1,1,2,1}},
{string(".????##?.???????"),{2,3}},
{string("?#?#??.?.."),{4,1}},
{string("?????????#?.???"),{1,6,1,1}},
{string("????#?#.???."),{7,3}},
{string("?????#??#?##?????.#?"),{12,2,1}},
{string("???#??#?.?#????#??"),{7,7}},
{string(".#.?.????????#."),{1,2,1,1,1}},
{string(".??.????##"),{1,5}},
{string("????#??.?#????.."),{2,1,4,1}},
{string(".???#??????#????????"),{1,1,11}},
{string(".?.???.???#?#."),{1,1,2,1}},
{string("??#????#??#????.."),{6,5}},
{string("#?##?.?#???#?"),{4,6}},
{string("????#????????????"),{1,2,1,1,4}},
{string("??????#??.????????"),{1,1,3,3,1}},
{string("?????.###??#??"),{1,1,8}},
{string("??##?.?????.?"),{4,2}},
{string("?#.??.????"),{2,1,2}},
{string("??#????.??#????."),{4,1,3,1}},
{string(".?????#?##??."),{1,7}},
{string("?###.??#?????."),{3,4}},
{string("??#????##?##???.??"),{4,6}},
{string("????#?#????#???#???"),{5,7}},
{string("?#??#?????"),{2,1,4}},
{string("#?#??.??#???.?"),{5,2,1}},
{string("?#?#??????"),{3,1,1}},
{string("?#?#??.????#?"),{5,6}},
{string("????.???#.???#"),{1,1,1,4}},
{string("?#????.????.???"),{4,3,2}},
{string(".???.?.????#??##?.?"),{1,9,1}},
{string("???.???#???.????#??"),{1,1,7,2,1,1}},
{string("?#??????.?#?"),{2,1,1,1}},
{string(".???#.???#??"),{3,4}},
{string("???#??#???"),{2,1}},
{string("???#?#?#?."),{3,1,1}},
{string("##????????"),{4,1}},
{string("?.?#???.##?"),{1,3,2}},
{string(".???.?.?#?????"),{1,1,1,3}},
{string("??#?..???????"),{2,1,1,1}},
{string(".#.??#?..?"),{1,3}},
{string("?.???#????."),{1,3}},
{string("????????#?#???"),{5,1,1,1}},
{string("??#??????.?#???..?"),{4,1,1,1,1,1}},
{string("??????.???##?"),{1,2,1,4}},
{string("???????#????????"),{1,12}},
{string("..??..?#????###?.?"),{1,10}},
{string("?????#?#??#?.??#?#?"),{1,1,7,1,1,1}},
{string(".?#????.??#??"),{6,1}},
{string("?#???..??????#?."),{1,2,1,6}},
{string("??.?#??#?##????#?#."),{1,2,11}},
{string("??#??.???#?#??#?#."),{4,1,5,1,1}},
{string(".#.?????#?????"),{1,1,7}},
{string("????#.????#?#?#?#"),{1,1,9}},
{string("#?.???#???.?#.?#?"),{2,4,1,2,1}},
{string(".???...???."),{3,1,1}},
{string("..?.???##?..??#???."),{2,3}},
{string("##?#?????????.??#"),{5,1,4,1,1}},
{string("?#????.?.??####"),{2,1,1,1,5}},
{string("?#????#?#."),{1,2,1}},
{string("?##?#??????#???????#"),{8,1,1,1,1}},
{string("?.??????#####??"),{2,7}},
{string("#????#?????#????.??#"),{10,5,2}},
{string("???#?....#?"),{3,1}},
{string(".?#???.???###?????"),{2,7,3}},
{string(".??????????????##"),{8,2,4}},
{string("?????????.#?#??."),{4,4}},
{string("?????????.?###???"),{1,2,3,5,1}},
{string("??#??##.?????."),{6,2}},
{string("..?.?##.???"),{1,2,1}},
{string("?.?.????.#?"),{1,3,2}},
{string("?#????????????.???"),{2,4,3,2}},
{string(".??..??.?.?#???????"),{2,1,8}},
{string("#????.?.#?????#"),{5,1,4}},
{string("?#????.?#??#.?.?"),{2,5,1}},
{string("??##???#???.??#.?"),{1,6,1,1,1}},
{string(".???????##???#?.."),{1,10}},
{string("?????.?..???..?"),{3,1,1,1,1}},
{string("??.????.???.?#."),{1,3,3,2}},
{string("???????.#?"),{1,1,1}},
{string("?.??#??????#???"),{5,4,2}},
{string(".???#?????#.?"),{1,3,1,2}},
{string("?#??#??.?????#?#??#?"),{5,1,1,1,1,3}},
{string("#.?#?????#??#???"),{1,9,1,1}},
{string("???..????#?#???#."),{1,1,2,7}},
{string(".??#?#?#??#?.?###??"),{2,3,3,3}},
{string("??????#?.????#"),{3,2,2}},
{string("#?##?#??#?##?"),{1,10}},
{string("?#??#.????#?##?"),{4,7}},
{string("??????#???#?..?#"),{7,1,1}},
{string("?????.?.?#??"),{1,1,1,1}},
{string(".???#?????#.?#?#?.?"),{5,2,1,1}},
{string("??.?#.????#?"),{1,2,1,1}},
{string("????#?#???????"),{2,6,1,1}},
{string("?.????????#?"),{1,3,1,2}},
{string("????????.#?#??"),{5,3}},
{string("??????#??.?"),{3,1}},
{string("...?#?????#??.?#"),{3,5,2}},
{string("?##?#????.??##?.?"),{6,1,4}},
{string("#?.?.??##?#?"),{1,1,5}},
{string("????#?#???#?????#."),{1,5,1,2,1}},
{string("##?#?#??.??.?????"),{8,1,1,1,1}},
{string("??#?#?????????#????"),{11,1,1}},
{string("??#.#???#???#?????"),{2,3,1,3,2}},
{string("?.??#?.??.???."),{1,3,1,1}},
{string("?#????#??????"),{1,5,3}},
{string("?#.?.??#?.?#???#"),{1,1,6}},
{string(".??????.?#????????"),{1,1,2,1,4}},
{string("?#??.??.??.?"),{1,1,1,1}},
{string("?#?##?#?????##?..##"),{9,1,3,2}},
{string("????.?#.???????.#"),{1,2,1,4,1}},
{string(".????.???#?##?"),{1,1,4}},
{string("?#?.?????#?..##?"),{1,2,2,3}},
{string("?#?#?.?#????#."),{3,2,2,1}},
{string("#.??#?#????"),{1,3,1}},
{string("???..##??.?"),{1,2,1}},
{string("???##????.?????????#"),{9,1,3,2}},
{string("####???.???#???#?"),{6,1,4,1}},
{string(".?#???????#."),{2,1,1,1}},
{string(".???????????"),{1,1,2,1}},
{string("#?##?#??##??"),{6,3}},
{string("..?.???.?."),{1,3,1}},
{string("?..?.?#??????.???.?"),{1,1,3,1,3,1}},
{string(".???.#???#??.?"),{1,7,1}},
{string("?##?.??##?.?????"),{4,4,2}},
{string("?.#####???#?????"),{7,4}},
{string("????#??.?##??"),{3,2,1}},
{string("??#.????.?#???##?#?"),{1,1,1,3,3,1}},
{string(".????..??#?#?##?#???"),{1,13}},
{string("?.???.????#??????"),{1,1,6,2}},
{string("..??.?????????????.."),{1,2}},
{string("?.????#.?#??"),{2,1,1,1}},
{string("???..#??#?.?"),{1,1,2,1}},
{string("??????.??#."),{1,3,2}},
{string("??#??#..#?."),{3,1,1}},
{string(".?..???#??#."),{1,4,2}},
{string("?.#.????.?"),{1,1,1}},
{string("?#?????.?.??.???#???"),{4,1,4}},
{string("?????#?#.??.?"),{4,3,1}},
{string("#?#??????##??#?#???."),{4,2,5,1,1}},
{string("????#?????#??##"),{2,3,3,2}},
{string("?.???????.?????"),{1,2,1,1,4}},
{string(".???.?.??#.#??"),{1,1,2,2}},
{string("?###?##?#?????..??"),{10,1}},
{string("???????#?????.#.??.#"),{6,1,1,1,1,1}},
{string("??.????#??????."),{4,1}},
{string("?#???#.??#?."),{3,1,2}},
{string("?##?#..?#?..??.."),{5,3,1}},
{string(".####?#???.?.?#?..."),{8,3}},
{string("????#?#????#??#?????"),{1,11,1,1,1}},
{string("????.??????#????"),{2,2,2,4}},
{string("?.#???#?#??."),{1,4}},
{string("??#???????#??...???"),{4,1,3,1,2}},
{string("??.???#???#???#??.?"),{1,3,5}},
{string("????#?..??"),{3,1}},
{string(".????#??.?.??"),{3,1,1}},
{string("??#?##????."),{1,4}},
{string("?#?..?????????#?."),{1,10}},
{string("#??##??..#.#?"),{7,1,2}},
{string("???###?????.???##"),{1,8,1,2}},
{string("#??#??.?????????..?"),{1,1,9,1}},
{string("????#?????#???.??"),{12,2}},
{string("?.????.?##????.??"),{1,3,3,1,1}},
{string("???##..????.?"),{1,2,4,1}},
{string("#?#??.???.??#?#??"),{1,3,1,5}},
{string("??#?#???????????"),{1,8,1,2}},
{string("#?????#??."),{3,3}},
{string(".????##??.?????"),{1,4,1,2}},
{string("????#??????..??.#"),{9,1,1,1}},
{string(".??????.#.#?"),{1,1,1,1}},
{string("?.??.#??.??.??#.?.?"),{2,3,1,3,1,1}},
{string("????##???##???#?#?"),{1,9,3}},
{string(".???.??.?#"),{1,1,1}},
{string("???#?????#??."),{3,1,2}},
{string("??????#.??????###.?"),{6,4,3}},
{string("?#?.???#???.?#..??"),{1,1,4,2,2}},
{string("??.?????.???###.???"),{2,2,1,5,2}},
{string("?###????#??"),{3,3}},
{string("?????##?.?#?##???."),{7,6}},
{string("???#???##?????"),{3,4,1}},
{string("..?????.?##????.??.."),{4,7}},
{string(".?...???#?"),{1,3}},
{string("??##??#????.#???????"),{3,1,1,6}},
{string("?..?.#?????#?"),{1,1,2,1}},
{string("???.??#????"),{1,5}},
{string(".?#??#???????????"),{1,3,1,1,1}},
{string("????#?#?.?#?"),{7,1}},
{string("?.???#??????.."),{5,1}},
{string("?#???.????.?#???"),{1,1,1,1,5}},
{string("?##????.?."),{2,1,1}},
{string("?#.?.##???"),{1,3}},
{string("?#??????.?..?.???."),{1,2}},
{string("#?????????#??#????"),{5,1,8}},
{string("???#.????.???"),{1,1,2,1}},
{string("????#??.##?"),{1,1,2}},
{string("???????#??#?"),{1,8}},
{string("?????.?????."),{2,1,1,1}},
{string("????.?#?###?.?#???."),{2,7,2,1}},
{string("???.##????????????."),{2,3,7}},
{string("#???#?????"),{3,1,1}},
{string("???##???##???#"),{1,3,3,1}},
{string("#???????#.?.?.??"),{9,1,2}},
{string("?#?????##???????"),{3,10}},
{string("???...?????###??"),{1,7}},
{string("???.??#?##?#?"),{1,1,2,1}},
{string("#.?#???#?????#."),{1,7,1,1}},
{string("#???????????"),{3,3,1}},
{string(".???.?.#?????#"),{1,7}},
{string("?###???#??#?.?#?????"),{12,1,1,1}},
{string(".??????#????.???"),{6,1}},
{string("?#?.##?##??.?"),{2,7}},
{string("???..??...??."),{1,1,2}},
{string("??#??#?#???#???????."),{7,4,3}},
{string("??.??#????."),{2,7}},
{string(".?#?.????#??#.??"),{2,7,1}},
{string("?.#.??#??#???.??"),{1,1,8,1}},
{string("????#??#?#.??.?.####"),{10,1,1,4}},
{string(".?#??????.?.????"),{8,2}},
{string("??#?.??.??"),{2,2}},
{string("??????.??????##??"),{4,4,5}},
{string("?#??#?.?#?"),{3,1,3}},
{string("???###????..????..?"),{7,4}},
{string("??.???????#?.?"),{2,5,1,1}},
{string("?#.?#??????"),{1,3,1}},
{string("?#??.??..##?.???#.?"),{4,1,2,1,1,1}},
{string("??????#????#?#??.??."),{1,3,8,2}},
{string("??????#?#????"),{6,3}},
{string("?????##????#?##?"),{2,3,1,5}},
{string("??#??#??####??.??##?"),{12,4}},
{string("..???##??#?#??.?."),{10,1}},
{string("?.?????##????"),{7,1}},
{string(".????#??#?##????.#?"),{2,11,2}},
{string("?????...?.##?##?"),{3,1,6}},
{string("?????#????.?"),{1,7,1}},
{string("?#???#?#??"),{3,1,2}},
{string("??#????????.?#??"),{1,4,2,1}},
{string("?????#?#???"),{1,6}},
{string("?...?#??..???????.?"),{1,4}},
{string("??.???##?#??##?.???"),{1,1,10,1,1}},
{string("???#?.?.??#?#?#"),{1,1,1,7}},
{string("?#?..???##??"),{3,1,4}},
{string("??.??.?#????##?.??#."),{1,1,9,2}},
{string("???????????"),{2,1,2}},
{string("..???????#?"),{1,2,1}},
{string("##??##?.?."),{2,2}},
{string("??###??.????#?"),{3,1,1,3}},
{string("?..???#?.?"),{1,5,1}},
{string(".#??????.#?."),{1,1,2,1}},
{string(".????#??????????.?"),{1,5,1,1,2}},
{string("????#????...??????#?"),{3,1,3,3,3}},
{string(".??????.??."),{3,1,1}},
{string("????#?#????#??#???"),{1,1,1,2,2,1}},
{string("???..#????.?"),{1,1,1,1}},
{string("?##??##?#.?#?.??."),{4,4,2,2}},
{string("..??????##????"),{3,4}},
{string("????.?.??#???"),{3,1,2,1}},
{string("???????.?."),{1,1,1}},
{string("..#?.?##?#????##??"),{2,11,1}},
{string("??????????#???."),{3,6}},
{string(".?????.??.?#??#"),{1,1,1,2,4}},
{string("?.???????."),{1,1,1}},
{string("???#??????#?##"),{4,1,1,2}},
{string(".?...?????.????"),{1,4,2}},
{string("?##??#?????..?.?"),{9,1}},
{string("??.??#????#?.#??#??"),{2,6,1,2}},
{string(".?..#??#??#.?#?##?.#"),{1,1,4,4,1}},
{string("??.?#??.#?"),{1,2,2}},
{string(".#??..???#."),{1,3}},
{string("???##.#?.??"),{4,2,1}},
{string("?.#??????.?##"),{2,1,3}},
{string("##????.?##?#??????"),{2,1,1,6,1,1}},
{string("#..???#???#??#???#?."),{1,6,1,1,1,1}},
{string("?.??.?#?#?.#"),{1,2,1,1}},
{string("..##?????.##"),{5,2}},
{string("??##..???#?##?????"),{1,2,8,3}},
{string(".??#?##?#?#?#??."),{10,1}},
{string("#??##?#??.??.#?"),{8,2,1}},
{string("????...??#?#?#??.???"),{2,8,3}},
{string("??..#.??#???.?#???"),{1,1,4,1,1,1}},
{string("???.?????.???.?#"),{3,1,1,1,1}},
{string(".??###.?#????."),{3,3}},
{string("##?#??.??..?##?."),{4,1,1,4}},
{string("##????.??#??????.???"),{6,3,1,2,1}},
{string("?#?#?#?#??????"),{1,1,1,5}},
{string(".????##????."),{2,6}},
{string("#???##???????.??????"),{10,1,1,1}},
{string("?#??.##?#??"),{3,2,2}},
{string("?#?????.#??##"),{1,2,2,2}},
{string(".?????????#??#?.??"),{1,1,9,1}},
{string("???????##?#?"),{1,1,4,2}},
{string("??#?.??????.??#??#?"),{4,1,1,1,1,5}},
{string("?#????.????"),{3,1,1}},
{string("??.?#??##?"),{1,2,3}},
{string(".????????.?"),{1,1}},
{string("???.???#?##?#?#??##"),{1,2,9,2}},
{string("?????#?##.?##"),{3,4,3}},
{string("#?????????"),{1,2,2}},
{string("?#..?#?.?#..??##????"),{2,1,2,1,3,1}},
{string("..??????????#?#?????"),{2,4,5,1,2}},
{string("??#?#?...????????"),{3,2}},
{string("??#.##??##??????"),{1,1,2,2,4}},
{string("?#?.??.???#?#"),{2,1,1,1}},
{string(".##.???#???#.?.?"),{2,1,2,1,1}},
{string("#???#???#????#??#."),{1,1,1,4,5}},
{string("?#?.????.?"),{1,1,1}},
{string("#?????..?."),{1,1,1}},
{string("??.?#???.??#?"),{2,1,2,3}},
{string("..??.?#???##?#??#?#?"),{1,14}},
{string("?.?#??#????##????##?"),{6,3,5}},
{string("????..?.?.???###??."),{1,1,1,1,5,1}},
{string("?.??#?.??.?##?#####"),{1,8}},
{string("?.?#?????.???"),{5,1}},
{string("???.##??????????"),{2,2,2,1,2}},
{string("?.##????##???????#.."),{2,11}},
{string("#???????#??#????"),{1,1,1,6,1}},
{string("#????#??????#"),{1,1,5}},
{string("??.#??#???..##??#?#?"),{1,6,7}},
{string("#??##?????????###?.."),{6,7}},
{string(".???????..#?.#??.?"),{2,2,1,2,3}},
{string("????????#?#???#???"),{11,1,1}},
{string("??..??.?????"),{2,1,1,3}},
{string("?.??#??#???"),{1,1,2}},
{string("??.??##?#.?#??#?.???"),{1,6,5,1,1}},
{string(".#?#?#??#?#??????"),{10,1,1}},
{string("????????????#."),{6,1,2}},
{string("??.??##???.???"),{5,1}},
{string(".??????#???###?.?"),{1,1,1,4,1}},
{string("#.??#???#????????."),{1,4,5,1}},
{string("##?##?????#???#??#??"),{15,1,1}},
{string(".????#?#?#???"),{2,1,5}},
{string("??###??.??"),{4,1}},
{string("??#?#??.??"),{4,1}},
{string("??.????.#.??#???"),{2,1,4}},
{string("?????..???#?.??"),{1,1,1,3,1}},
{string("?.#???????????#???#"),{5,1,3,3}},
{string(".???????????.??"),{2,6}},
{string("??#?????#.?#?????"),{8,4}},
{string("??#...#????"),{1,3}},
{string("?.??.#??.####?"),{2,3,4}},
{string("#?????#?????#??#?."),{1,1,1,1,3,1}},
{string("????#????###"),{2,8}},
{string("?????..??."),{2,2}},
{string("?.??#..???#?##??"),{3,7}},
{string("?##????##??#."),{2,1,4,1}},
{string(".#?????????##?.?#..#"),{1,3,1,4,1,1}},
{string("?#?#??#????.#.#??."),{1,1,3,1,1,1}},
{string("??#???.??????#?.."),{2,1,3,3}},
{string("#?##???#????#."),{1,11}},
{string("??..?..????#???#"),{1,1,1,3,2}},
{string("??#?.?#?#?"),{3,4}},
{string("??#???#??#?#"),{3,3,1,1}},
{string("#.?..?##?#????#??##?"),{1,1,3,4,1,2}},
{string("???????#?.?????#??"),{6,7}},
{string("?#??#??.?????#."),{5,6}},
{string("?.??..???#?..??.???"),{3,1}},
{string("?#??#???#?"),{1,1,2}},
{string("?.??##???????????"),{10,3}},
{string("##?..#???#?.??"),{3,3,2,1}},
{string("??#???..?#????"),{5,6}},
{string("?#?.??#???.??#??"),{3,3,1,1}},
{string(".#???????.#????##?."),{3,3,7}},
{string("?.??##??..??"),{3,2}},
{string("?#??.???.???.?#?"),{4,1,1,2}},
{string("?##?.#??#??"),{2,1,2}},
{string(".???#?.???????##.??"),{2,3}},
{string("?#??#??.?.????..??"),{1,4,1,1,1,1}},
{string("?.????????."),{1,6,1}},
{string("?????##?#????.#."),{8,1,1}},
{string("?..?????????????????"),{1,11,1,1}},
{string("..?#?????#...?"),{1,3}},
{string("?.?#???#.??"),{2,2,1}},
{string("##??.???.??"),{3,1,1}},
{string("???##??.?.#?"),{5,1}},
{string("??.?..#??.?.?"),{1,3}},
{string(".???.?##?????????"),{3,11}},
{string("#..?#???#??.????"),{1,8,2}},
{string(".??????.?.?.????#?#?"),{5,1,2,5}},
{string(".?????#???#???..???"),{5,3,1,2}},
{string("?????#????.?"),{8,1}},
{string(".??#.??????##?.."),{1,9}},
{string("#???#?#..??#?#???#"),{1,1,1,1,7,1}},
{string("#.?#??##???#."),{1,1,2,1}},
{string(".??????.?#????"),{4,5}},
{string("???##?.??????.#.??.?"),{3,6,1,1}},
{string("????.#???????"),{1,4,1}},
{string("??##?.????"),{3,1}},
{string(".??##?????#?#???#?"),{1,4,6,1}},
{string("??#?####?##?.??#?#?"),{12,3}},
{string("#.?.??##?#.?????"),{1,1,4,1,1}},
{string("???????..#"),{1,1}},
{string("?????#??????#."),{2,5,4}},
{string("??#???#???.??#?"),{7,1,1,1}},
{string("??????.?###."),{2,4}},
{string("?#.??#??#????."),{1,8}},
{string("???#???##??#??"),{1,9,1}},
{string("??###??????????"),{11,2}},
{string("??...??.#?#??#??."),{2,1,1,1,3}},
{string("???.????#??.?."),{3,1,2,1}},
{string("??###??#????."),{1,3,2,2}},
{string("??#???????##??"),{4,1,5}},
{string("?#????????#.???"),{1,7,1,1}},
{string("???#???#?????#"),{1,1,7}},
{string("?????.??.??????"),{2,1,2,1}},
{string("??????#?#??#?.??"),{1,1,3,1,1}},
{string("?##?#??#?.#?"),{2,1,1,1}},
{string("?.???.??.???????"),{1,1,2,2}},
{string("????????..???#?"),{1,1,1,1,2}},
{string("??????.##?.?###?????"),{5,3,3,2}},
{string("#???????##"),{1,1,5}},
{string("???.??#??#??#.#"),{2,1,1,5,1}},
{string("???#????.#?#?"),{4,2,3}},
{string("??.#??##?????"),{2,7,1}},
{string("???#?.?.??????"),{5,1,2,1}},
{string("???.????.?"),{1,1,1}},
{string("???????##???????."),{1,8,1}},
{string("??.?#???.#??#??"),{1,1,2,2,1}},
{string("?.???????.??#??#?.??"),{7,6}},
{string("?????..?#???."),{2,3}},
{string("???##??#??.??"),{9,1}},
{string("??#?##??#??.???#??"),{11,5}},
{string("????????#??#??#"),{4,9}},
{string(".??.?.????"),{1,1,1}},
{string("??????##.????"),{3,3,2,1}},
{string("????????#???#??#????"),{1,11}},
{string("#.????#?????#?#????"),{1,1,1,4,5,1}},
{string("??..????????.??.????"),{2,1}},
{string("#.?#?#?..?.###?#??"),{1,2,2,1,5,1}},
{string("?????.#.??#"),{4,1,1}},
{string("?.?.?????????????#?"),{1,9,1}},
{string("???..###?.?"),{2,3}},
{string("???#???#.####????"),{3,1,6}},
{string("?#???#??????##?..?"),{1,7,3}},
{string("????#.????#??.??.??"),{4,1,3,1,1}},
{string("???#???????"),{2,2}},
{string("#.??.???#??#???#?"),{1,1,4,2,3}},
{string("#???#.???????##???"),{1,1,2,1,5}},
{string(".????#?????#?????"),{1,4,5}},
{string("??#..#??#?"),{1,1,1}},
{string("..?#?????."),{3,1}},
{string("??.???##??"),{1,2,3}},
{string("????.?????"),{1,1,1}},
{string("?##???.#?#???.#.#?"),{2,1,1,3,1,1}},
{string("??.#?????##?#..??.??"),{1,2,1,5,2,1}},
{string(".??????#??#????#.?"),{1,4,1,4}},
{string("??#?#?#?##????.??"),{1,10,1,1}},
{string(".????????#"),{2,1,1}},
{string("??#???.????.##??"),{3,1,2,4}},
{string("???.##?.???.???#?.??"),{2,2,2,1,2,2}},
{string("?##?????#?????#??"),{2,4,1,4}},
{string("??.?#??#???????.??"),{2,2,1}},
{string("#??#??????.????#?"),{1,7,3}},
{string("?.#???#.#?"),{1,5,1}},
{string(".?#?????#??.?"),{4,3,1}},
{string(".##??.?????.??"),{4,1,2,1}},
{string("???#??#?.??"),{1,3,2}},
{string("?##???#????."),{2,1,1,2}},
{string("????.###??"),{2,3}},
{string("#.??#??????????????"),{1,5,6,1,1}},
{string("????#????#?.#"),{2,7,1}},
{string("????.??#.?"),{3,1}},
{string("??????..?##.??????"),{2,1,3,1,1,1}},
{string("?#??.?##?#???"),{1,1,7}},
{string("#?.??.#..???"),{2,1,1,1}},
{string("??????#??.??#??#"),{1,2,3,1}},
{string("??##??##??#?.."),{1,2,3,3}},
{string("???????????"),{1,6,1}},
{string("??????.##???#???"),{2,8}},
{string("#????????#??"),{1,1,1,2}},
{string("???????.???"),{2,2,1}},
{string("?.????..??.?.??"),{1,3,2,1}},
{string("#??.#?#????"),{1,3,1}},
{string("???###.?..#???.#??."),{6,1,1,1,3}},
{string(".#??????#?#?????"),{2,2,3,4}},
{string("?????..#.#?"),{3,1,1}},
{string(".?????#.???#??"),{6,3}},
{string(".#??##.???#?#?#????"),{1,2,1,6,1}},
{string(".??#????#?#.?????.?"),{9,1,1,1}},
{string("?????????#??."),{3,3}},
{string("?#..?#???#?"),{2,1,3}},
{string(".#.??#?###.???"),{1,6,2}},
{string("?.??.?#?.?"),{1,2,3}},
{string("??#.????????.???#?"),{1,1,1,2,4}},
{string("???????#??#?#??.?"),{2,1,4,1,1}},
{string("?????#???..#??"),{1,2,1,2}},
{string(".???#?#????????"),{3,1,2,4}},
{string("???##??.??#?."),{5,3}},
{string("?#.??#??.?"),{2,3,1}},
{string(".#.?#?#????.???????"),{1,6,1,3,1,1}},
{string("?????#???????##??#"),{1,3,7,1}},
{string(".???????#??.?"),{1,2,2,1}},
{string("?#??####???"),{8,1}},
{string("??????.??##???##?#??"),{2,1,5,4}},
{string("?.???????..??.?##???"),{1,4,1,1,6}},
{string("??#?#???????????..#?"),{3,5,1,1,2,1}},
{string("??#???#.???.??"),{2,1,1,2}},
{string("?##?##.?????##??#"),{2,2,7,1}},
{string("????.???#?#?.?#?"),{1,2,2,4,2}},
{string("?#.?#?.?#?"),{2,1,3}},
{string("???????#?#???"),{1,8,1}},
{string("??????#??#??."),{4,3,1,1}},
{string("???#??##?#??.?.???#?"),{2,5,2,1,1,1}},
{string(".??#??.??###??.??"),{3,6}},
{string("?????#.?#???"),{3,1,3}},
{string("???.??.??#????"),{1,1,3,1}},
{string(".?.?.###???#?????#"),{1,1,7,1,2}},
{string(".?##?.??.#??###.?."),{4,2,6,1}},
{string("##.??#???#####?#???"),{2,3,10}},
{string("???????????"),{1,1,3}},
{string("?.???##???..?."),{1,5,1,1}},
{string("??#?#?#?#?#???#"),{10,2}},
{string("???#?#??#?##??#????"),{16,1}},
{string(".?..?.??.?#??.#"),{1,1,2,4,1}},
{string("?#.?#????#.??#?"),{1,1,2,1,3}},
{string("?.#???#???#?#???"),{6,4}},
{string("?..???.#?#??.??.?.?"),{1,2,5,1,1}},
{string("?#.????##??###????"),{2,5,7}},
{string(".##????###??#..#????"),{10,1,3}},
{string("?#??.???.?#"),{4,2,1}},
{string("????##?????.??#?.?.?"),{1,7,3,1}},
{string("?##??.???#????????#?"),{2,1,3,8}},
{string("????#??..???.?????."),{2,3,1,3}},
{string("?#.#???#???.??.????"),{2,2,1,1,2,1}},
{string("...?????.??"),{1,2,1}},
};

TEST(Aoc12_2_Tests, doPuzzle) {
	ASSERT_EQ(7705, doTheThing(puzzleInput));
}


TEST(Aoc12_2_Tests, doPuzzle2) {
	ASSERT_EQ(0, doTheThing2(puzzleInput));
}


const std::vector<int64_t> previousAnswers =
{
4,
1,
6,
2,
2,
3,
3,
22,
3,
1,
3,
1,
6,
4,
10,
1,
15,
8,
37,
2,
1,
11,
6,
2,
4,
4,
2,
2,
10,
7,
27,
14,
2,
6,
13,
10,
10,
3,
2,
1,
2,
12,
2,
1,
6,
8,
23,
36,
8,
11,
8,
5,
9,
78,
21,
11,
7,
24,
1,
4,
1,
11,
4,
2,
6,
3,
13,
3,
4,
38,
1,
8,
3,
2,
21,
6,
1,
6,
9,
91,
2,
2,
2,
2,
7,
26,
4,
30,
3,
6,
8,
1,
5,
4,
16,
3,
3,
2,
33,
10,
4,
3,
11,
2,
4,
9,
6,
2,
7,
4,
3,
12,
8,
13,
2,
27,
3,
1,
2,
4,
2,
3,
18,
1,
3,
2,
8,
3,
19,
8,
22,
1,
4,
12,
3,
6,
4,
9,
2,
3,
1,
3,
3,
1,
3,
6,
6,
1,
2,
4,
1,
1,
21,
2,
10,
2,
1,
7,
10,
4,
2,
2,
3,
13,
6,
2,
5,
16,
2,
10,
1,
1,
5,
3,
4,
5,
1,
7,
11,
3,
2,
4,
5,
4,
8,
1,
4,
13,
3,
6,
1,
8,
3,
2,
2,
3,
4,
6,
2,
2,
6,
35,
13,
18,
25,
3,
5,
24,
8,
1,
16,
2,
24,
10,
9,
3,
7,
20,
3,
6,
6,
2,
19,
6,
1,
1,
5,
6,
2,
5,
20,
2,
6,
7,
2,
2,
3,
10,
3,
2,
3,
5,
4,
1,
3,
5,
2,
2,
6,
3,
2,
3,
2,
3,
2,
10,
6,
1,
6,
2,
18,
13,
6,
3,
5,
2,
27,
3,
13,
4,
5,
9,
2,
2,
106,
1,
6,
5,
10,
7,
10,
3,
4,
3,
5,
2,
6,
9,
13,
2,
2,
1,
12,
2,
5,
1,
3,
1,
28,
6,
10,
2,
13,
8,
1,
3,
6,
1,
210,
1,
2,
1,
2,
16,
22,
12,
2,
6,
12,
4,
48,
3,
2,
10,
12,
4,
1,
2,
12,
2,
1,
6,
1,
1,
2,
9,
7,
1,
9,
1,
3,
14,
10,
18,
10,
2,
13,
2,
2,
1,
27,
2,
14,
4,
3,
6,
2,
1,
1,
7,
1,
2,
3,
2,
10,
10,
9,
5,
15,
9,
2,
4,
1,
5,
6,
35,
10,
2,
8,
2,
4,
3,
12,
5,
2,
2,
5,
4,
8,
4,
3,
15,
4,
2,
3,
2,
1,
10,
4,
1,
6,
1,
4,
6,
6,
10,
8,
2,
7,
4,
7,
2,
2,
2,
6,
3,
5,
4,
6,
17,
10,
8,
21,
6,
25,
11,
6,
1,
3,
23,
18,
16,
9,
3,
3,
3,
5,
2,
4,
6,
2,
4,
2,
2,
9,
7,
10,
2,
1,
12,
7,
7,
3,
2,
2,
35,
1,
23,
1,
7,
23,
19,
8,
6,
3,
7,
3,
2,
2,
2,
11,
51,
16,
21,
14,
2,
2,
1,
8,
3,
10,
1,
6,
4,
4,
2,
3,
11,
8,
3,
2,
71,
100,
6,
8,
7,
21,
6,
3,
5,
8,
2,
5,
6,
2,
11,
8,
8,
2,
9,
3,
2,
1,
5,
2,
10,
20,
2,
7,
7,
8,
8,
6,
2,
4,
1,
1,
4,
2,
6,
4,
3,
1,
3,
3,
1,
1,
17,
9,
1,
2,
2,
1,
6,
4,
4,
3,
4,
33,
8,
1,
4,
5,
5,
8,
4,
15,
1,
1,
10,
2,
2,
1,
7,
1,
2,
3,
18,
3,
6,
5,
10,
4,
7,
3,
6,
3,
13,
2,
10,
6,
14,
3,
1,
44,
12,
1,
16,
11,
5,
1,
4,
6,
6,
1,
9,
35,
2,
1,
9,
3,
8,
1,
3,
7,
4,
28,
79,
2,
7,
3,
2,
1,
12,
42,
3,
4,
6,
8,
4,
9,
19,
14,
4,
2,
1,
3,
3,
2,
6,
10,
5,
13,
2,
2,
1,
6,
1,
3,
22,
2,
10,
3,
3,
22,
2,
10,
2,
6,
7,
9,
2,
3,
6,
3,
4,
16,
2,
3,
8,
5,
10,
55,
2,
10,
6,
4,
1,
6,
6,
23,
4,
5,
22,
9,
9,
4,
6,
2,
5,
12,
4,
3,
10,
4,
3,
21,
2,
8,
9,
1,
4,
4,
2,
3,
4,
3,
1,
4,
2,
7,
4,
4,
2,
9,
6,
4,
6,
3,
4,
3,
2,
9,
10,
5,
2,
2,
3,
4,
35,
6,
1,
3,
1,
3,
6,
3,
6,
22,
17,
2,
6,
8,
25,
1,
14,
1,
25,
10,
6,
5,
2,
1,
4,
1,
2,
4,
4,
1,
3,
1,
1,
2,
1,
6,
4,
25,
2,
2,
12,
1,
3,
24,
2,
3,
8,
3,
4,
18,
6,
29,
3,
2,
10,
2,
1,
8,
2,
8,
8,
2,
7,
7,
2,
4,
6,
3,
1,
7,
20,
1,
15,
1,
2,
2,
1,
7,
2,
5,
4,
6,
6,
10,
17,
10,
1,
2,
5,
5,
12,
16,
3,
6,
2,
1,
1,
11,
2,
5,
3,
1,
4,
5,
9,
1,
6,
4,
3,
1,
4,
2,
10,
2,
3,
2,
2,
9,
2,
2,
22,
2,
2,
6,
1,
6,
11,
1,
4,
7,
3,
3,
2,
3,
4,
8,
4,
1,
1,
1,
6,
6,
13,
8,
2,
1,
17,
7,
1,
3,
5,
3,
2,
3,
4,
7,
3,
10,
1,
3,
89,
13,
1,
102,
70,
6,
2,
2,
3,
2,
7,
29,
35,
2,
2,
8,
4,
2,
2,
17,
2,
22,
3,
76,
1,
2,
11,
2,
3,
3,
28,
10,
8,
10,
16,
1,
5,
2,
40,
2,
4,
5,
2,
10,
12,
12,
4,
24,
4,
1,
6,
6,
2,
2,
3,
5,
3,
3,
24,
2,
7,
18,
1,
4,
5,
16,
19,
6,
3,
2,
2,
3,
3,
7,
7,
15,
2,
2,
1,
50,
18,
11,
1,
6,
4,
1,
14,
12,
3,
12,
6,
1,
9,
2,
2,
1,
4,
1,
2,
6,
4,
47,
2,
1,
6,
35,
3,
2,
3,
1,
2,
2,
10,
3,
1,
2,
24,
4,
32,
12,
6};

TEST(Aoc12_2_Tests, CompareWithEarlier) {
	for (int64_t i = 0; i < ssize(puzzleInput); i++) {
		std::cout << i << ": " << puzzleInput[i].first << " " << puzzleInput[i].second << std::endl;
		int64_t result = findArrangements(puzzleInput[i].first, puzzleInput[i].second);
		int64_t expected = previousAnswers[i];
		ASSERT_EQ(expected, result);
	}
}